define(["libs/underscore"],function(e){function t(t,r){var i=e.size(t);if(i==0)return{};var s={},o=e.keys(t[0]);return e.each(o,function(i){e.has(r,i)?s[i]=r[i](e.pluck(t,i)):e.isNumber(t[0][i])?s[i]=n(e.pluck(t,i)):s[i]=t[0][i]}),s}function n(t){return r(t)/e.size(t)}function r(t){return e.reduce(t,function(e,t){return e+t},0)}function i(n){return e.chain(n).groupBy("name").map(function(n){return t(n,{min:e.min,max:e.max,count:r})}).value()}function s(e,t,n,r){e[n]===t?e[r]=!e[r]:e[r]=!1,e[n]=t}return{averageMetrics:i,sortBy:s}})