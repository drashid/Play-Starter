define(["controller/controllers","libs/jquery","libs/underscore","libs/bootstrap-tooltip","libs/bootstrap-popover"],function(e,t,n){e.controller("HealthCtrl",["$scope","$http",function(r,i){r.loadHealth=function(){i.get("/api/admin/metrics/health").success(function(e){r.health=n.sortBy(e,"timestamp").reverse()})},r.clearMachine=function(e){t("[rel=tooltip]").tooltip("hide"),i.post("/api/admin/metrics/remove",{machine:e}).success(function(){r.refresh()})},r.refresh=function(){r.loadHealth()},r.healthStatus=function(e){return e.healthy?"alert-success":"alert-error"},r.healthInfo=function(e){var t=_healthIcon(e);return e.message?'<i class="'+t+'" rel="popover" data-content="'+e.message+'" data-original-title="Status Message"></i>':'<i class="'+t+'"></i>'},r.diffTime=function(e){return Math.round(((new Date).getTime()-e)/1e3)},_healthIcon=function(e){return e.healthy?"icon-ok":"icon-remove"},r.$watch("health",function(){r.$evalAsync(function(){t("[rel=popover]").popover({placement:"bottom"}),t("[rel=tooltip]").tooltip({placement:"right"})})}),r.loadHealth()}])})