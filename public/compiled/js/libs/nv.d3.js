(function(){function e(e,t,n){return function(r,i,s){var o=e(r),u=[];o<r&&t(o);if(s>1)while(o<i){var f=new Date(+o);n(f)%s===0&&u.push(f),t(o)}else while(o<i)u.push(new Date(+o)),t(o);return u}}function t(e,t){return(new Date(t,e+1,0)).getDate()}var n={version:"0.0.1a",dev:!0};window.nv=n,n.tooltip={},n.utils={},n.models={},n.charts={},n.graphs=[],n.logs={},n.dispatch=d3.dispatch("render_start","render_end"),n.dev&&(n.dispatch.on("render_start",function(e){n.logs.startTime=+(new Date)}),n.dispatch.on("render_end",function(e){n.logs.endTime=+(new Date),n.logs.totalTime=n.logs.endTime-n.logs.startTime,n.log("total",n.logs.totalTime)})),n.log=function(){return n.dev&&console.log&&console.log.apply(console,arguments),arguments[arguments.length-1]},n.render=function r(e){e=e||1,r.active=!0,n.dispatch.render_start(),setTimeout(function(){var t;for(var i=0;i<e&&(graph=r.queue[i]);i++)t=graph.generate(),typeof graph.callback==typeof Function&&graph.callback(t),n.graphs.push(t);r.queue.splice(0,i),r.queue.length?setTimeout(arguments.callee,0):(n.render.active=!1,n.dispatch.render_end())},0)},n.render.queue=[],n.addGraph=function(e){typeof arguments[0]==typeof Function&&(e={generate:arguments[0],callback:arguments[1]}),n.render.queue.push(e),n.render.active||n.render()},n.identity=function(e){return e},n.strip=function(e){return e.replace(/(\s|&)/g,"")},d3.time.monthEnd=function(e){return new Date(e.getFullYear(),e.getMonth(),0)},d3.time.monthEnds=e(d3.time.monthEnd,function(e){e.setUTCDate(e.getUTCDate()+1),e.setDate(t(e.getMonth()+1,e.getFullYear()))},function(e){return e.getMonth()}),function(){var e=window.nv.tooltip={};e.show=function(e,t,r,i,s,o){var u=document.createElement("div");u.className="nvtooltip "+(o?o:"xy-tooltip"),r=r||"s",i=i||20;var f=s?s:document.getElementsByTagName("body")[0];u.innerHTML=t,u.style.left=0,u.style.top=0,u.style.opacity=0,f.appendChild(u);var l=parseInt(u.offsetHeight),c=parseInt(u.offsetWidth),h=n.utils.windowSize().width,p=n.utils.windowSize().height,d=f.scrollTop,v=f.scrollLeft,m,g;switch(r){case"e":m=e[0]-c-i,g=e[1]-l/2,m<v&&(m=e[0]+i),g<d&&(g=d+5),g+l>d+p&&(g=d-l-5);break;case"w":m=e[0]+i,g=e[1]-l/2,m+c>h&&(m=e[0]-c-i),g<d&&(g=d+5),g+l>d+p&&(g=d-l-5);break;case"n":m=e[0]-c/2,g=e[1]+i,m<v&&(m=v+5),m+c>h&&(m=h-c-5),g+l>d+p&&(g=e[1]-l-i);break;case"s":m=e[0]-c/2,g=e[1]-l-i,m<v&&(m=v+5),m+c>h&&(m=h-c-5),d>g&&(g=e[1]+20)}return u.style.left=m+"px",u.style.top=g+"px",u.style.opacity=1,u.style.position="absolute",u.style.pointerEvents="none",u},e.cleanup=function(){var e=document.getElementsByClassName("nvtooltip"),t=[];while(e.length)t.push(e[0]),e[0].style.transitionDelay="0 !important",e[0].style.opacity=0,e[0].className="nvtooltip-pending-removal";setTimeout(function(){while(t.length){var e=t.pop();e.parentNode.removeChild(e)}},500)}}(),n.utils.windowSize=function(){var e={width:640,height:480};return document.body&&document.body.offsetWidth&&(e.width=document.body.offsetWidth,e.height=document.body.offsetHeight),document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth&&(e.width=document.documentElement.offsetWidth,e.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(e.width=window.innerWidth,e.height=window.innerHeight),e},n.utils.windowResize=function(e){var t=window.onresize;window.onresize=function(n){typeof t=="function"&&t(n),e(n)}},n.models.axis=function(){function e(n){return n.each(function(e){var n=d3.select(this),l=n.selectAll("g.wrap.axis").data([e]),p=l.enter().append("g").attr("class","wrap axis"),v=p.append("g"),m=l.select("g");(a.orient()=="top"||a.orient()=="bottom")&&a.ticks(Math.abs(r.range()[1]-r.range()[0])/100),d3.transition(m).call(a),f=f||a.scale();var y=m.selectAll("text.axislabel").data([i||null]);y.exit().remove();switch(a.orient()){case"top":y.enter().append("text").attr("class","axislabel").attr("text-anchor","middle").attr("y",0);var b=r.range().length==2?r.range()[1]:r.range()[r.range().length-1]+(r.range()[1]-r.range()[0]);y.attr("x",b/2);if(s){var w=l.selectAll("g.axisMaxMin").data(r.domain());w.enter().append("g").attr("class","axisMaxMin").append("text"),w.exit().remove(),w.attr("transform",function(e,t){return"translate("+r(e)+",0)"}).select("text").attr("dy","0em").attr("y",-a.tickPadding()).attr("text-anchor","middle").text(function(e,t){return(""+a.tickFormat()(e)).match("NaN")?"":a.tickFormat()(e)}),d3.transition(w).attr("transform",function(e,t){return"translate("+r.range()[t]+",0)"})}break;case"bottom":y.enter().append("text").attr("class","axislabel").attr("text-anchor","middle").attr("y",30);var b=r.range().length==2?r.range()[1]:r.range()[r.range().length-1]+(r.range()[1]-r.range()[0]);y.attr("x",b/2);if(s){var w=l.selectAll("g.axisMaxMin").data(r.domain());w.enter().append("g").attr("class","axisMaxMin").append("text"),w.exit().remove(),w.attr("transform",function(e,t){return"translate("+r(e)+",0)"}).select("text").attr("dy",".71em").attr("y",a.tickPadding()).attr("text-anchor","middle").text(function(e,t){return(""+a.tickFormat()(e)).match("NaN")?"":a.tickFormat()(e)}),d3.transition(w).attr("transform",function(e,t){return"translate("+r.range()[t]+",0)"})}break;case"right":y.enter().append("text").attr("class","axislabel").attr("text-anchor",u?"middle":"begin").attr("transform",u?"rotate(90)":"").attr("y",u?-Math.max(margin.right,t)-12:-10),y.attr("x",u?r.range()[0]/2:a.tickPadding());if(s){var w=l.selectAll("g.axisMaxMin").data(r.domain());w.enter().append("g").attr("class","axisMaxMin").append("text").style("opacity",0),w.exit().remove(),w.attr("transform",function(e,t){return"translate(0,"+r(e)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",a.tickPadding()).attr("text-anchor","start").text(function(e,t){return(""+a.tickFormat()(e)).match("NaN")?"":a.tickFormat()(e)}),d3.transition(w).attr("transform",function(e,t){return"translate(0,"+r.range()[t]+")"}).select("text").style("opacity",1)}break;case"left":y.enter().append("text").attr("class","axislabel").attr("text-anchor",u?"middle":"end").attr("transform",u?"rotate(-90)":"").attr("y",u?-Math.max(margin.left,t)+12:-10),y.attr("x",u?-r.range()[0]/2:-a.tickPadding());if(s){var w=l.selectAll("g.axisMaxMin").data(r.domain());w.enter().append("g").attr("class","axisMaxMin").append("text").style("opacity",0),w.exit().remove(),w.attr("transform",function(e,t){return"translate(0,"+f(e)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",-a.tickPadding()).attr("text-anchor","end").text(function(e,t){return(""+a.tickFormat()(e)).match("NaN")?"":a.tickFormat()(e)}),d3.transition(w).attr("transform",function(e,t){return"translate(0,"+r.range()[t]+")"}).select("text").style("opacity",1)}}y.text(function(e){return e}),s&&(a.orient()==="left"||a.orient()==="right")&&m.selectAll("g").each(function(e,t){if(r(e)<r.range()[1]+10||r(e)>r.range()[0]-10)e>1e-10||e<-1e-10?d3.select(this).remove():d3.select(this).select("text").remove()});if(s&&(a.orient()==="top"||a.orient()==="bottom")){var E=[];l.selectAll("g.axisMaxMin").each(function(e,t){t?E.push(r(e)-this.getBBox().width-4):E.push(r(e)+this.getBBox().width+4)}),m.selectAll("g").each(function(e,t){if(r(e)<E[0]||r(e)>E[1])e>1e-10||e<-1e-10?d3.select(this).remove():d3.select(this).select("text").remove()})}o&&m.selectAll("line.tick").filter(function(e){return!parseFloat(Math.round(e*1e5)/1e6)}).classed("zero",!0),f=r.copy()}),e}var t=60,n=60,r=d3.scale.linear(),i=null,s=!0,o=!0,u=!0;margin={top:0,right:0,bottom:0,left:0};var a=d3.svg.axis().scale(r).orient("bottom").tickFormat(function(e){return e}),f;return d3.rebind(e,a,"orient","ticks","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),d3.rebind(e,r,"domain","range","rangeBand","rangeBands"),e.width=function(n){return arguments.length?(t=n,e):t},e.height=function(t){return arguments.length?(n=t,e):n},e.axisLabel=function(t){return arguments.length?(i=t,e):i},e.showMaxMin=function(t){return arguments.length?(s=t,e):s},e.highlightZero=function(t){return arguments.length?(o=t,e):o},e.scale=function(t){return arguments.length?(r=t,a.scale(r),d3.rebind(e,r,"domain","range","rangeBand","rangeBands"),e):r},e.rotateYLabel=function(t){return arguments.length?(u=t,e):u},e.margin=function(t){return arguments.length?(margin=t,e):margin},e},n.models.historicalBar=function(){function e(v){return v.each(function(e){var v=n-t.left-t.right,m=r-t.top-t.bottom;p.domain(c||d3.extent(e[0].values.map(s).concat(u))).range([0,v]),d.domain(h||d3.extent(e[0].values.map(o).concat(a))).range([m,0]);if(p.domain()[0]===p.domain()[1]||d.domain()[0]===d.domain()[1])singlePoint=!0;p.domain()[0]===p.domain()[1]&&(p.domain()[0]?p.domain([p.domain()[0]-p.domain()[0]*.01,p.domain()[1]+p.domain()[1]*.01]):p.domain([-1,1])),d.domain()[0]===d.domain()[1]&&(d.domain()[0]?d.domain([d.domain()[0]+d.domain()[0]*.01,d.domain()[1]-d.domain()[1]*.01]):d.domain([-1,1]));var y=d3.select(this).on("click",function(e,t){g.chartClick({data:e,index:t,pos:d3.event,id:i})}),w=d3.select(this).selectAll("g.wrap.bar").data([e[0].values]),E=w.enter().append("g").attr("class","wrap nvd3 bar"),S=E.append("g");S.append("g").attr("class","bars"),w.attr("width",n).attr("height",r);var x=w.select("g").attr("transform","translate("+t.left+","+t.top+")");E.append("defs").append("clipPath").attr("id","chart-clip-path-"+i).append("rect"),w.select("#chart-clip-path-"+i+" rect").attr("width",v).attr("height",m),S.attr("clip-path",f?"url(#chart-clip-path-"+i+")":"");var T=S.append("g").attr("class","shiftWrap"),N=w.select(".bars").selectAll(".bar").data(function(e){return e});N.exit().remove();var C=N.enter().append("svg:rect").attr("class",function(e,t){return o(e,t)<0?"bar negative":"bar positive"}).attr("fill",function(e,t){return l[0]}).attr("x",0).attr("y",function(e,t){return d(Math.max(0,o(e,t)))}).attr("height",function(e,t){return Math.abs(d(o(e,t))-d(0))}).on("mouseover",function(t,n){d3.select(this).classed("hover",!0),g.elementMouseover({point:t,series:e[0],pos:[p(s(t,n)),d(o(t,n))],pointIndex:n,seriesIndex:0,e:d3.event})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),g.elementMouseout({point:t,series:e[0],pointIndex:n,seriesIndex:0,e:d3.event})}).on("click",function(e,t){g.elementClick({value:o(e,t),data:e,index:t,pos:[p(s(e,t)),d(o(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()}).on("dblclick",function(e,t){g.elementDblClick({value:o(e,t),data:e,index:t,pos:[p(s(e,t)),d(o(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()});N.attr("class",function(e,t){return o(e,t)<0?"bar negative":"bar positive"}).attr("transform",function(t,n){return"translate("+(p(s(t,n))-v/e[0].values.length*.5)+",0)"}).attr("width",v/e[0].values.length*.9),d3.transition(N).attr("y",function(e,t){return d(Math.max(0,o(e,t)))}).attr("height",function(e,t){return Math.abs(d(o(e,t))-d(0))})}),e}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*1e4),s=function(e){return e.x},o=function(e){return e.y},u=[],a=[],f=!0,l=d3.scale.category20().range(),c,h,p=d3.scale.linear(),d=d3.scale.linear(),v=d3.svg.axis().scale(p).orient("bottom"),m=d3.svg.axis().scale(d).orient("left"),g=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return e.dispatch=g,e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.xScale=function(t){return arguments.length?(p=t,e):p},e.yScale=function(t){return arguments.length?(d=t,e):d},e.xDomain=function(t){return arguments.length?(c=t,e):c},e.yDomain=function(t){return arguments.length?(h=t,e):h},e.forceX=function(t){return arguments.length?(u=t,e):u},e.forceY=function(t){return arguments.length?(a=t,e):a},e.clipEdge=function(t){return arguments.length?(f=t,e):f},e.color=function(t){return arguments.length?(l=t,e):l},e.id=function(t){return arguments.length?(i=t,e):i},e},n.models.bullet=function(){function e(e){e.each(function(e,t){var f=u-r.left-r.right,p=a-r.top-r.bottom,v=i.call(this,e,t).slice().sort(d3.descending),m=s.call(this,e,t).slice().sort(d3.descending),y=o.call(this,e,t).slice().sort(d3.descending),w=d3.select(this).selectAll("g.wrap.bullet").data([e]),E=w.enter().append("g").attr("class","wrap nvd3 bullet"),S=E.append("g"),x=w.select("g");w.attr("transform","translate("+r.left+","+r.top+")");var T=d3.scale.linear().domain([0,Math.max(v[0],m[0],y[0])]).range(n?[f,0]:[0,f]),N=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(T.range());this.__chart__=T;var C=function(e){return Math.abs(N(e)-N(0))},k=function(e){return Math.abs(T(e)-T(0))},L=x.selectAll("rect.range").data(v);L.enter().append("rect").attr("class",function(e,t){return"range s"+t}).attr("width",C).attr("height",p).attr("x",n?N:0).on("mouseover",function(e,t){l.elementMouseover({value:e,label:t<=0?"Maximum":t>1?"Minimum":"Mean",pos:[T(e),p/2]})}).on("mouseout",function(e,t){l.elementMouseout({value:e,label:t<=0?"Minimum":t>=1?"Maximum":"Mean"})}),d3.transition(L).attr("x",n?T:0).attr("width",k).attr("height",p);var A=x.selectAll("rect.measure").data(y);A.enter().append("rect").attr("class",function(e,t){return"measure s"+t}).attr("width",C).attr("height",p/3).attr("x",n?N:0).attr("y",p/3).on("mouseover",function(e){l.elementMouseover({value:e,label:"Current",pos:[T(e),p/2]})}).on("mouseout",function(e){l.elementMouseout({value:e,label:"Current"})}),d3.transition(A).attr("width",k).attr("height",p/3).attr("x",n?T:0).attr("y",p/3);var O=x.selectAll("path.markerTriangle").data(m),M=p/6;O.enter().append("path").attr("class","markerTriangle").attr("transform",function(e){return"translate("+N(e)+","+p/2+")"}).attr("d","M0,"+M+"L"+M+","+ -M+" "+ -M+","+ -M+"Z").on("mouseover",function(e,t){l.elementMouseover({value:e,label:"Previous",pos:[T(e),p/2]})}).on("mouseout",function(e,t){l.elementMouseout({value:e,label:"Previous"})}),d3.transition(O).attr("transform",function(e){return"translate("+T(e)+","+p/2+")"}),O.exit().remove()}),d3.timer.flush()}var t="left",n=!1,r={top:0,right:0,bottom:0,left:0},i=function(e){return e.ranges},s=function(e){return e.markers},o=function(e){return e.measures},u=380,a=30,f=null,l=d3.dispatch("elementMouseover","elementMouseout");return e.dispatch=l,e.orient=function(r){return arguments.length?(t=r,n=t=="right"||t=="bottom",e):t},e.ranges=function(t){return arguments.length?(i=t,e):i},e.markers=function(t){return arguments.length?(s=t,e):s},e.measures=function(t){return arguments.length?(o=t,e):o},e.width=function(t){return arguments.length?(u=t,e):u},e.height=function(t){return arguments.length?(a=t,e):a},e.margin=function(t){return arguments.length?(r=t,e):r},e.tickFormat=function(t){return arguments.length?(f=t,e):f},e},n.models.bulletChart=function(){function e(e){e.each(function(e,t){var p=d3.select(this),y=(f||parseInt(p.style("width"))||960)-i.left-i.right,b=l-i.top-i.bottom,w=this,E=s.call(this,e,t).slice().sort(d3.descending),S=o.call(this,e,t).slice().sort(d3.descending),x=u.call(this,e,t).slice().sort(d3.descending),T=p.selectAll("g.wrap.bulletChart").data([e]),N=T.enter().append("g").attr("class","wrap nvd3 bulletChart"),C=N.append("g");C.append("g").attr("class","bulletWrap"),C.append("g").attr("class","titles");var L=T.select("g");T.attr("transform","translate("+i.left+","+i.top+")");var A=d3.scale.linear().domain([0,Math.max(E[0],S[0],x[0])]).range(r?[y,0]:[0,y]),O=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(A.range());this.__chart__=A;var M=function(e){return Math.abs(O(e)-O(0))},_=function(e){return Math.abs(A(e)-A(0))},D=L.select(".titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(l-i.top-i.bottom)/2+")");D.append("text").attr("class","title").text(function(e){return e.title}),D.append("text").attr("class","subtitle").attr("dy","1em").text(function(e){return e.subtitle}),v.width(y).height(b);var P=L.select(".bulletWrap");d3.transition(P).call(v);var H=c||A.tickFormat(8),B=L.selectAll("g.tick").data(A.ticks(8),function(e){return this.textContent||H(e)}),F=B.enter().append("g").attr("class","tick").attr("transform",function(e){return"translate("+O(e)+",0)"}).style("opacity",1e-6);F.append("line").attr("y1",b).attr("y2",b*7/6),F.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",b*7/6).text(H),d3.transition(F).attr("transform",function(e){return"translate("+A(e)+",0)"}).style("opacity",1);var I=d3.transition(B).attr("transform",function(e){return"translate("+A(e)+",0)"}).style("opacity",1);I.select("line").attr("y1",b).attr("y2",b*7/6),I.select("text").attr("y",b*7/6),d3.transition(B.exit()).attr("transform",function(e){return"translate("+A(e)+",0)"}).style("opacity",1e-6).remove(),v.dispatch.on("elementMouseover.tooltip",function(e){d.tooltipShow(e)}),h&&d.on("tooltipShow",function(e){m(e,w.parentNode)}),v.dispatch.on("elementMouseout.tooltip",function(e){d.tooltipHide(e)}),h&&d.on("tooltipHide",n.tooltip.cleanup)}),d3.timer.flush()}var t="left",r=!1,i={top:5,right:40,bottom:20,left:120},s=function(e){return e.ranges},o=function(e){return e.markers},u=function(e){return e.measures},f=null,l=55,c=null,h=!0,p=function(e,t,n,r,i){return"<h3>"+r.label+"</h3>"+"<p>"+r.value+"</p>"},d=d3.dispatch("tooltipShow","tooltipHide"),v=n.models.bullet(),m=function(e,t){var t=document.getElementById("chart"),r=e.pos[0]+t.offsetLeft+i.left,s=e.pos[1]+t.offsetTop+i.top,o="<h3>"+e.label+"</h3>"+"<p>"+e.value+"</p>";n.tooltip.show([r,s],o,e.value<0?"e":"w")};return e.dispatch=d,e.bullet=v,e.orient=function(n){return arguments.length?(t=n,r=t=="right"||t=="bottom",e):t},e.ranges=function(t){return arguments.length?(s=t,e):s},e.markers=function(t){return arguments.length?(o=t,e):o},e.measures=function(t){return arguments.length?(u=t,e):u},e.width=function(t){return arguments.length?(f=t,e):f},e.height=function(t){return arguments.length?(l=t,e):l},e.margin=function(t){return arguments.length?(i=t,e):i},e.tickFormat=function(t){return arguments.length?(c=t,e):c},e.tooltips=function(t){return arguments.length?(h=t,e):h},e.tooltipContent=function(t){return arguments.length?(p=t,e):p},e},n.models.cumulativeLineChart=function(){function e(e,t){return t.map(function(t,n){var r=y.y()(t.values[e],e);return t.values=t.values.map(function(e,t){return e.display={y:(y.y()(e,t)-r)/(1+r)},e}),t})}function t(n){return n.each(function(r){var i=d3.select(this).classed("chart-"+w,!0),s=this,v=(f||parseInt(i.style("width"))||960)-o.left-o.right,O=(l||parseInt(i.style("height"))||400)-o.top-o.bottom;m=y.xScale(),g=y.yScale(),b.domain([0,r[0].values.length-1]).range([0,v]).clamp(!0);var r=e(C.i,r),M=i.selectAll("g.wrap.cumulativeLine").data([r]),_=M.enter().append("g").attr("class","wrap nvd3 cumulativeLine").append("g");_.append("g").attr("class","x axis"),_.append("g").attr("class","y axis"),_.append("g").attr("class","linesWrap"),_.append("g").attr("class","legendWrap"),_.append("g").attr("class","controlsWrap");var D=M.select("g");c&&(x.width(v),D.select(".legendWrap").datum(r).call(x),o.top!=x.height()&&(o.top=x.height(),O=(l||parseInt(i.style("height"))||400)-o.top-o.bottom),D.select(".legendWrap").attr("transform","translate(0,"+ -o.top+")")),p&&(T.width(140).color(["#444","#444","#444"]),D.select(".controlsWrap").datum(k).attr("transform","translate(0,"+ -o.top+")").call(T)),y.y(function(e){return e.display.y}).width(v).height(O).color(r.map(function(e,t){return e.color||u[t%u.length]}).filter(function(e,t){return!r[t].disabled})),D.attr("transform","translate("+o.left+","+o.top+")");var P=D.select(".linesWrap").datum(r.filter(function(e){return!e.disabled}));d3.transition(P).call(y);var H=P.selectAll(".indexLine").data([C]);H.enter().append("rect").attr("class","indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",.5).call(A),H.attr("transform",function(e){return"translate("+b(e.i)+",0)"}).attr("height",O),E.scale(m).ticks(v/100).tickSize(-O,0),D.select(".x.axis").attr("transform","translate(0,"+g.range()[0]+")"),d3.transition(D.select(".x.axis")).call(E),S.scale(g).ticks(O/36).tickSize(-v,0),d3.transition(D.select(".y.axis")).call(S),T.dispatch.on("legendClick",function(e,r){e.disabled=!e.disabled,d=!e.disabled,n.transition().call(t)}),x.dispatch.on("legendClick",function(e,i){e.disabled=!e.disabled,r.filter(function(e){return!e.disabled}).length||r.map(function(e){return e.disabled=!1,M.selectAll(".series").classed("disabled",!1),e}),n.transition().call(t)}),N.on("tooltipShow",function(e){h&&L(e,s.parentNode)})}),t.update=function(){t(n)},t.container=this,t}function r(e,n){t.update()}function i(e,t){e.x+=d3.event.dx,e.i=Math.round(b.invert(e.x)),d3.select(this).attr("transform","translate("+b(e.i)+",0)")}function s(e,t){}var o={top:30,right:20,bottom:50,left:60},u=d3.scale.category20().range(),f=null,l=null,c=!0,h=!0,p=!1,d=!0,v=function(e,t,n,r,i){return"<h3>"+e+"</h3>"+"<p>"+n+" at "+t+"</p>"},m,g,y=n.models.line(),b=d3.scale.linear(),w=y.id(),E=n.models.axis().orient("bottom").tickPadding(5),S=n.models.axis().orient("left"),x=n.models.legend().height(30),T=n.models.legend().height(30),N=d3.dispatch("tooltipShow","tooltipHide"),C={i:0,x:0},k=[{key:"Re-scale y-axis"}],L=function(e,r){var i=e.pos[0]+(r.offsetLeft||0),s=e.pos[1]+(r.offsetTop||0),o=E.tickFormat()(y.x()(e.point,e.pointIndex)),u=S.tickFormat()(y.y()(e.point,e.pointIndex)),f=v(e.series.key,o,u,e,t);n.tooltip.show([i,s],f)},A=d3.behavior.drag().on("dragstart",s).on("drag",i).on("dragend",r);return y.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+o.left,e.pos[1]+o.top],N.tooltipShow(e)}),y.dispatch.on("elementMouseout.tooltip",function(e){N.tooltipHide(e)}),N.on("tooltipHide",function(){h&&n.tooltip.cleanup()}),t.dispatch=N,t.legend=x,t.xAxis=E,t.yAxis=S,d3.rebind(t,y,"defined","isArea","x","y","size","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id"),t.margin=function(e){return arguments.length?(o=e,t):o},t.width=function(e){return arguments.length?(f=e,t):f},t.height=function(e){return arguments.length?(l=e,t):l},t.color=function(e){return arguments.length?(u=e,x.color(e),t):u},t.showLegend=function(e){return arguments.length?(c=e,t):c},t.tooltips=function(e){return arguments.length?(h=e,t):h},t.tooltipContent=function(e){return arguments.length?(v=e,t):v},t},n.models.discreteBar=function(){function e(i){return i.each(function(y){var w=n-t.left-t.right,E=r-t.top-t.bottom;y=y.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e});var S=p&&d?[]:y.map(function(e){return e.values.map(function(e,t){return{x:u(e,t),y:a(e,t),y0:e.y0}})});s.domain(p||d3.merge(S).map(function(e){return e.x})).rangeBands([0,w],.1),o.domain(d||d3.extent(d3.merge(S).map(function(e){return e.y}).concat(f))),c?o.range([E-(o.domain()[0]<0?12:0),o.domain()[1]>0?12:0]):o.range([E,0]),m=m||s,g=g||o.copy().range([o(0),o(0)]);var x=d3.select(this).selectAll("g.wrap.discretebar").data([y]),T=x.enter().append("g").attr("class","wrap nvd3 discretebar"),N=T.append("g");N.append("g").attr("class","groups");var C=x.select("g");x.attr("transform","translate("+t.left+","+t.top+")");var L=x.select(".groups").selectAll(".group").data(function(e){return e},function(e){return e.key});L.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),d3.transition(L.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),L.attr("class",function(e,t){return"group series-"+t}).classed("hover",function(e){return e.hover}),d3.transition(L).style("stroke-opacity",1).style("fill-opacity",.75);var A=L.selectAll("g.bar").data(function(e){return e.values});A.exit().remove();var O=A.enter().append("g").attr("transform",function(e,t,n){return"translate("+s(u(e,t))+", "+o(0)+")"}).on("mouseover",function(e,t){d3.select(this).classed("hover",!0),v.elementMouseover({value:a(e,t),point:e,series:y[e.series],pos:[s(u(e,t))+s.rangeBand()*(e.series+.5)/y.length,o(a(e,t))],pointIndex:t,seriesIndex:e.series,e:d3.event})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),v.elementMouseout({value:a(e,t),point:e,series:y[e.series],pointIndex:t,seriesIndex:e.series,e:d3.event})}).on("click",function(e,t){v.elementClick({value:a(e,t),point:e,series:y[e.series],pos:[s(u(e,t))+s.rangeBand()*(e.series+.5)/y.length,o(a(e,t))],pointIndex:t,seriesIndex:e.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(e,t){v.elementDblClick({value:a(e,t),point:e,series:y[e.series],pos:[s(u(e,t))+s.rangeBand()*(e.series+.5)/y.length,o(a(e,t))],pointIndex:t,seriesIndex:e.series,e:d3.event}),d3.event.stopPropagation()});O.append("rect").attr("height",0).attr("width",s.rangeBand()/y.length).style("fill",function(e,t){return e.color||l[t%l.length]}).style("stroke",function(e,t){return e.color||l[t%l.length]}),c?(O.append("text").attr("text-anchor","middle"),A.selectAll("text").attr("x",s.rangeBand()/2).attr("y",function(e,t){return a(e,t)<0?o(a(e,t))-o(0)+12:-4}).text(function(e,t){return h(a(e,t))})):A.selectAll("text").remove(),A.attr("class",function(e,t){return a(e,t)<0?"bar negative":"bar positive"}).attr("transform",function(e,t){return"translate("+s(u(e,t))+", "+(a(e,t)<0?g(0):g(a(e,t)))+")"}).selectAll("rect").attr("width",s.rangeBand()/y.length),d3.transition(A).attr("transform",function(e,t){return"translate("+s(u(e,t))+", "+(a(e,t)<0?o(0):o(a(e,t)))+")"}).selectAll("rect").attr("height",function(e,t){return Math.abs(o(a(e,t))-o(0))}),e.update=function(){e(i)},m=s.copy(),g=o.copy()}),e}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*1e4),s=d3.scale.ordinal(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=[0],l=d3.scale.category20().range(),c=!1,h=d3.format(",.2f"),p,d,v=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),m,g;return e.dispatch=v,e.x=function(t){return arguments.length?(u=t,e):u},e.y=function(t){return arguments.length?(a=t,e):a},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.xScale=function(t){return arguments.length?(s=t,e):s},e.yScale=function(t){return arguments.length?(o=t,e):o},e.xDomain=function(t){return arguments.length?(p=t,e):p},e.yDomain=function(t){return arguments.length?(d=t,e):d},e.forceY=function(t){return arguments.length?(f=t,e):f},e.color=function(t){return arguments.length?(l=t,e):l},e.id=function(t){return arguments.length?(i=t,e):i},e.showValues=function(t){return arguments.length?(c=t,e):c},e.valueFormat=function(t){return arguments.length?(h=t,e):h},e},n.models.discreteBarChart=function(){function e(s){return s.each(function(l){var y=d3.select(this),w=this,E=(r||parseInt(y.style("width"))||960)-t.left-t.right,S=(i||parseInt(y.style("height"))||400)-t.top-t.bottom;c.width(E).height(S);var x=y.selectAll("g.wrap.discreteBarWithAxes").data([l]),T=x.enter().append("g").attr("class","wrap nvd3 discreteBarWithAxes").append("g"),N=T.append("defs");T.append("g").attr("class","x axis"),T.append("g").attr("class","y axis"),T.append("g").attr("class","barsWrap");var C=x.select("g");C.attr("transform","translate("+t.left+","+t.top+")");var L=C.select(".barsWrap").datum(l.filter(function(e){return!e.disabled}));d3.transition(L).call(c),N.append("clipPath").attr("id","x-label-clip-"+c.id()).append("rect"),C.select("#x-label-clip-"+c.id()+" rect").attr("width",h.rangeBand()*(o?2:1)).attr("height",16).attr("x",-h.rangeBand()/(o?1:2)),d.ticks(E/100).tickSize(-S,0),C.select(".x.axis").attr("transform","translate(0,"+(p.range()[0]+(c.showValues()&&p.domain()[0]<0?16:0))+")"),C.select(".x.axis").transition().duration(0).call(d);var A=C.select(".x.axis").selectAll("g");o&&A.selectAll("text").attr("transform",function(e,t,n){return"translate(0,"+(n%2==0?"0":"12")+")"}),u&&A.selectAll("text").attr("transform",function(e,t,n){return"rotate("+u+" 0,0)"}).attr("text-anchor",u>0?"start":"end"),A.selectAll("text").attr("clip-path",function(e,t,n){return u?"":"url(#x-label-clip-"+c.id()+")"}),v.ticks(S/36).tickSize(-E,0),d3.transition(C.select(".y.axis")).call(v),c.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],m.tooltipShow(e)}),f&&m.on("tooltipShow",function(e){g(e,w.parentNode)}),c.dispatch.on("elementMouseout.tooltip",function(e){m.tooltipHide(e)}),f&&m.on("tooltipHide",n.tooltip.cleanup),e.update=function(){s.transition().call(e)},e.container=this}),e}var t={top:10,right:10,bottom:50,left:60},r=null,i=null,s=d3.scale.category20().range(),o=!1,u=0,f=!0,l=function(e,t,n,r,i){return"<h3>"+t+"</h3>"+"<p>"+n+"</p>"},c=n.models.discreteBar(),h=c.xScale(),p=c.yScale(),d=n.models.axis().scale(h).orient("bottom").highlightZero(!1).showMaxMin(!1),v=n.models.axis().scale(p).orient("left"),m=d3.dispatch("tooltipShow","tooltipHide");d.tickFormat(function(e){return e}),v.tickFormat(d3.format(",.1f"));var g=function(t,r){var i=t.pos[0]+(r.offsetLeft||0),s=t.pos[1]+(r.offsetTop||0),o=d.tickFormat()(c.x()(t.point,t.pointIndex)),u=v.tickFormat()(c.y()(t.point,t.pointIndex)),f=l(t.series.key,o,u,t,e);n.tooltip.show([i,s],f,t.value<0?"n":"s")},y=[{key:"Grouped"},{key:"Stacked",disabled:!0}];return e.dispatch=m,e.discretebar=c,e.xAxis=d,e.yAxis=v,d3.rebind(e,c,"x","y","xDomain","yDomain","forceX","forceY","id","showValues","valueFormat"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(s=t,c.color(t),e):s},e.staggerLabels=function(t){return arguments.length?(o=t,e):o},e.rotateLabels=function(t){return arguments.length?(u=t,e):u},e.tooltips=function(t){return arguments.length?(f=t,e):f},e.tooltipContent=function(t){return arguments.length?(l=t,e):l},e},n.models.distribution=function(){function e(u){return u.each(function(e){var u=n-(i==="x"?t.left+t.right:t.top+t.bottom),l=i=="x"?"y":"x";f=f||a;var p=d3.select(this).selectAll("g.distribution").data([e]),v=p.enter().append("g").attr("class","nvd3 distribution"),m=v.append("g"),g=p.select("g");p.attr("transform","translate("+t.left+","+t.top+")");var y=g.selectAll("g.dist").data(function(e){return e},function(e){return e.key});y.enter().append("g"),y.attr("class",function(e,t){return"dist series-"+t}).style("stroke",function(e,t){return o[t%o.length]});var w=y.selectAll("line.dist"+i).data(function(e){return e.values});w.enter().append("line").attr(i+"1",function(e,t){return f(s(e,t))}).attr(i+"2",function(e,t){return f(s(e,t))}),d3.transition(y.exit().selectAll("line.dist"+i)).attr(i+"1",function(e,t){return a(s(e,t))}).attr(i+"2",function(e,t){return a(s(e,t))}).style("stroke-opacity",0).remove(),w.attr("class",function(e,t){return"dist"+i+" dist"+i+"-"+t}).attr(l+"1",0).attr(l+"2",r),d3.transition(w).attr(i+"1",function(e,t){return a(s(e,t))}).attr(i+"2",function(e,t){return a(s(e,t))}),f=a.copy()}),e}var t={top:0,right:0,bottom:0,left:0},n=400,r=8,i="x",s=function(e){return e[i]},o=d3.scale.category20().range(),u,a=d3.scale.linear(),f;return e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.axis=function(t){return arguments.length?(i=t,e):i},e.size=function(t){return arguments.length?(r=t,e):r},e.getData=function(t){return arguments.length?(s=d3.functor(t),e):s},e.scale=function(t){return arguments.length?(a=t,e):a},e.color=function(t){return arguments.length?(o=t,e):o},e},n.models.indentedTree=function(){function e(i){return i.each(function(s){function l(e){var t=e.values||e._values;return t&&t.length}function p(e){return e._values&&e._values.length}function v(e){return e._values&&e._values.length?iconOpen:e.values&&e.values.length?iconClose:""}function m(t,n,r){d3.event.stopPropagation();if(d3.event.shiftKey&&!r)return d3.event.shiftKey=!1,t.values&&t.values.forEach(function(e){(e.values||e._values)&&m(e,0,!0)}),!0;if(!l(t))return!0;t.values?(t._values=t.values,t.values=null):(t.values=t._values,t._values=null),e.update()}var y=n-t.left-t.right,w=r-t.top-t.bottom;e.update=function(){i.transition().call(e)};var E=0,S=1,x=d3.layout.tree().children(function(e){return e.values}).size([r,childIndent]);s[0].key||(s[0].key=u);var T=x.nodes(s[0]),N=d3.select(this).selectAll("div").data([[T]]),C=N.enter().append("div").attr("class","wrap nvd3 indentedtree"),k=C.append("table"),L=N.select("table").attr("width","100%").attr("class",tableClass);if(o){var A=k.append("thead"),O=A.append("tr");columns.forEach(function(e){O.append("th").attr("width",e.width?e.width:"10%").style("text-align",e.type=="numeric"?"right":"left").append("span").text(e.label)})}var M=L.selectAll("tbody").data(function(e){return e});M.enter().append("tbody"),S=d3.max(T,function(e){return e.depth}),x.size([r,S*childIndent]);var _=M.selectAll("tr").data(function(e){return e},function(e){return e.id||e.id==++E});_.exit().remove(),_.select("img.treeicon").attr("src",v).classed("folded",p);var D=_.enter().append("tr");columns.forEach(function(e,t){var n=D.append("td").style("padding-left",function(e){return(t?0:e.depth*childIndent+12+(v(e)?0:16))+"px"},"important").style("text-align",e.type=="numeric"?"right":"left");t==0&&n.append("img").classed("treeicon",!0).classed("folded",p).attr("src",v).style("width","14px").style("height","14px").style("padding","0 1px").style("display",function(e){return v(e)?"inline-block":"none"}).on("click",m),n.append("span").attr("class",d3.functor(e.classes)).text(function(t){return e.format?e.format(t):t[e.key]||"-"}),e.showCount&&n.append("span").attr("class","childrenCount").text(function(e){return e.values&&e.values.length||e._values&&e._values.length?"("+(e.values&&e.values.length||e._values&&e._values.length)+")":""}),e.click&&n.select("span").on("click",e.click)}),_.order().on("click",function(e){a.elementClick({row:this,data:e,pos:[e.x,e.y]})}).on("dblclick",function(e){a.elementDblclick({row:this,data:e,pos:[e.x,e.y]})}).on("mouseover",function(e){a.elementMouseover({row:this,data:e,pos:[e.x,e.y]})}).on("mouseout",function(e){a.elementMouseout({row:this,data:e,pos:[e.x,e.y]})})}),e}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=d3.scale.category20().range(),s=Math.floor(Math.random()*1e4),o=!0,u="No Results found.";childIndent=20,columns=[{key:"key",label:"Name",type:"text"}],tableClass=null,iconOpen="images/grey-plus.png",iconClose="images/grey-minus.png";var a=d3.dispatch("elementClick","elementDblclick","elementMouseover","elementMouseout");return e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.color=function(t){return arguments.length?(i=t,scatter.color(t),e):i},e.id=function(t){return arguments.length?(s=t,e):s},e.header=function(t){return arguments.length?(o=t,e):o},e.noResultsText=function(t){return arguments.length?(u=t,e):u},e.columns=function(t){return arguments.length?(columns=t,e):columns},e.tableClass=function(t){return arguments.length?(tableClass=t,e):tableClass},e.iconOpen=function(t){return arguments.length?(iconOpen=t,e):iconOpen},e.iconClose=function(t){return arguments.length?(iconClose=t,e):iconClose},e},n.models.legend=function(){function e(l){return l.each(function(e){var l=n-t.left-t.right,h=d3.select(this).selectAll("g.legend").data([e]),p=h.enter().append("g").attr("class","nvd3 legend").append("g"),v=h.select("g").attr("transform","translate("+t.left+","+t.top+")"),m=v.selectAll(".series").data(function(e){return e}),y=m.enter().append("g").attr("class","series").on("mouseover",function(e,t){u.legendMouseover(e,t)}).on("mouseout",function(e,t){u.legendMouseout(e,t)}).on("click",function(e,t){u.legendClick(e,t)}).on("dblclick",function(e,t){u.legendDblclick(e,t)});y.append("circle").style("fill",function(e,t){return e.color||s[t%s.length]}).style("stroke",function(e,t){return e.color||s[t%s.length]}).style("stroke-width",2).attr("r",5),y.append("text").text(i).attr("text-anchor","start").attr("dy",".32em").attr("dx","8"),m.classed("disabled",function(e){return e.disabled}),m.exit().remove();if(o){var w=[];m.each(function(e,t){w.push(d3.select(this).select("text").node().getComputedTextLength()+28)});var E=0,S=0,x=[];while(S<l&&E<w.length)x[E]=w[E],S+=w[E++];while(S>l&&E>1){x=[],E--;for(k=0;k<w.length;k++)w[k]>(x[k%E]||0)&&(x[k%E]=w[k]);S=x.reduce(function(e,t,n,r){return e+t})}var T=[];for(var N=0,C=0;N<E;N++)T[N]=C,C+=x[N];m.attr("transform",function(e,t){return"translate("+T[t%E]+","+(5+Math.floor(t/E)*20)+")"}),v.attr("transform","translate("+(n-t.right-S)+","+t.top+")"),r=t.top+t.bottom+Math.ceil(w.length/E)*20}else{var L=5,A=5,O=0,M;m.attr("transform",function(e,r){var i=d3.select(this).select("text").node().getComputedTextLength()+28;return M=A,n<t.left+t.right+M+i&&(A=M=5,L+=20),A+=i,A>O&&(O=A),"translate("+M+","+L+")"}),v.attr("transform","translate("+(n-t.right-O)+","+t.top+")"),r=t.top+t.bottom+L+15}}),e}var t={top:5,right:0,bottom:5,left:0},n=400,r=20,i=function(e){return e.key},s=d3.scale.category20().range(),o=!0,u=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout");return e.dispatch=u,e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.key=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(s=t,e):s},e.align=function(t){return arguments.length?(o=t,e):o},e},n.models.line=function(){function e(n){return n.each(function(e){var n=r-t.left-t.right,a=i-t.top-t.bottom,b=d3.select(this);p=m.xScale(),d=m.yScale(),g=g||p,y=y||d;var w=b.selectAll("g.wrap.line").data([e]),E=w.enter().append("g").attr("class","wrap nvd3 line"),S=E.append("defs"),x=E.append("g"),T=w.select("g");x.append("g").attr("class","groups"),x.append("g").attr("class","scatterWrap");var N=w.select(".scatterWrap");m.width(n).height(a),d3.transition(N).call(m),w.attr("transform","translate("+t.left+","+t.top+")"),S.append("clipPath").attr("id","edge-clip-"+o).append("rect"),w.select("#edge-clip-"+o+" rect").attr("width",n).attr("height",a),T.attr("clip-path",h?"url(#edge-clip-"+o+")":""),N.attr("clip-path",h?"url(#edge-clip-"+o+")":"");var C=w.select(".groups").selectAll(".group").data(function(e){return e},function(e){return e.key});C.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),d3.transition(C.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),C.attr("class",function(e,t){return"group series-"+t}).classed("hover",function(e){return e.hover}).style("fill",function(e,t){return s[t%s.length]}).style("stroke",function(e,t){return s[t%s.length]}),d3.transition(C).style("stroke-opacity",1).style("fill-opacity",.5);var L=C.selectAll("path.area").data(function(e){return[e]});L.enter().append("path").filter(c).attr("class","area").attr("d",function(e){return d3.svg.area().interpolate(v).defined(l).x(function(e,t){return g(u(e,t))}).y0(function(e,t){return y(f(e,t))}).y1(function(e,t){return y(d.domain()[0]<=0?d.domain()[1]>=0?0:d.domain()[1]:d.domain()[0])}).apply(this,[e.values])}),d3.transition(C.exit().selectAll("path.area")).attr("d",function(e){return d3.svg.area().interpolate(v).defined(l).x(function(e,t){return g(u(e,t))}).y0(function(e,t){return y(f(e,t))}).y1(function(e,t){return y(d.domain()[0]<=0?d.domain()[1]>=0?0:d.domain()[1]:d.domain()[0])}).apply(this,[e.values])}),d3.transition(L.filter(c)).attr("d",function(e){return d3.svg.area().interpolate(v).defined(l).x(function(e,t){return g(u(e,t))}).y0(function(e,t){return y(f(e,t))}).y1(function(e,t){return y(d.domain()[0]<=0?d.domain()[1]>=0?0:d.domain()[1]:d.domain()[0])}).apply(this,[e.values])});var A=C.selectAll("path.line").data(function(e){return[e.values]});A.enter().append("path").attr("class",function(e){return"line"}).attr("d",d3.svg.line().interpolate(v).defined(l).x(function(e,t){return g(u(e,t))}).y(function(e,t){return y(f(e,t))})),d3.transition(C.exit().selectAll("path.line")).attr("d",d3.svg.line().interpolate(v).defined(l).x(function(e,t){return p(u(e,t))}).y(function(e,t){return d(f(e,t))})),d3.transition(A).attr("d",d3.svg.line().interpolate(v).defined(l).x(function(e,t){return p(u(e,t))}).y(function(e,t){return d(f(e,t))})),g=p.copy(),y=d.copy()}),e}var t={top:0,right:0,bottom:0,left:0},r=960,i=500,s=d3.scale.category20().range(),o=Math.floor(Math.random()*1e4),u=function(e){return e.x},f=function(e){return e.y},l=function(e,t){return!isNaN(f(e,t))&&f(e,t)!==null},c=function(e){return e.area},h=!1,p,d,v="linear",m=n.models.scatter().id(o).size(16).sizeDomain([16,256]),g,y,b;return e.dispatch=m.dispatch,d3.rebind(e,m,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","clipVoronoi","clipRadius"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.x=function(t){return arguments.length?(u=t,m.x(t),e):u},e.y=function(t){return arguments.length?(f=t,m.y(t),e):f},e.clipEdge=function(t){return arguments.length?(h=t,e):h},e.color=function(t){return arguments.length?(s=t,m.color(t),e):s},e.id=function(t){return arguments.length?(o=t,e):o},e.interpolate=function(t){return arguments.length?(v=t,e):v},e.defined=function(t){return arguments.length?(l=t,e):l},e.isArea=function(t){return arguments.length?(c=d3.functor(t),e):c},e},n.models.lineChart=function(){function e(n){return n.each(function(f){var y=d3.select(this),w=this,E=(i||parseInt(y.style("width"))||960)-t.left-t.right,S=(s||parseInt(y.style("height"))||400)-t.top-t.bottom;l=h.xScale(),c=h.yScale();var x=y.selectAll("g.wrap.lineChart").data([f]),T=x.enter().append("g").attr("class","wrap nvd3 lineChart").append("g");T.append("g").attr("class","x axis"),T.append("g").attr("class","y axis"),T.append("g").attr("class","linesWrap"),T.append("g").attr("class","legendWrap");var N=x.select("g");o&&(v.width(E),N.select(".legendWrap").datum(f).call(v),t.top!=v.height()&&(t.top=v.height(),S=(s||parseInt(y.style("height"))||400)-t.top-t.bottom),N.select(".legendWrap").attr("transform","translate(0,"+ -t.top+")")),h.width(E).height(S).color(f.map(function(e,t){return e.color||r[t%r.length]}).filter(function(e,t){return!f[t].disabled})),N.attr("transform","translate("+t.left+","+t.top+")");var C=N.select(".linesWrap").datum(f.filter(function(e){return!e.disabled}));d3.transition(C).call(h),p.scale(l).ticks(E/100).tickSize(-S,0),N.select(".x.axis").attr("transform","translate(0,"+c.range()[0]+")"),d3.transition(N.select(".x.axis")).call(p),d.scale(c).ticks(S/36).tickSize(-E,0),d3.transition(N.select(".y.axis")).call(d),v.dispatch.on("legendClick",function(t,r){t.disabled=!t.disabled,f.filter(function(e){return!e.disabled}).length||f.map(function(e){return e.disabled=!1,x.selectAll(".series").classed("disabled",!1),e}),n.transition().call(e)}),m.on("tooltipShow",function(e){u&&g(e,w.parentNode)})}),e.update=function(){e(n)},e.container=this,e}var t={top:30,right:20,bottom:50,left:60},r=d3.scale.category20().range(),i=null,s=null,o=!0,u=!0,f=function(e,t,n,r,i){return"<h3>"+e+"</h3>"+"<p>"+n+" at "+t+"</p>"},l,c,h=n.models.line(),p=n.models.axis().orient("bottom").tickPadding(5),d=n.models.axis().orient("left"),v=n.models.legend().height(30),m=d3.dispatch("tooltipShow","tooltipHide"),g=function(t,r){if(r){var i=d3.select(r).select("svg"),s=i.attr("viewBox");if(s){s=s.split(" ");var o=parseInt(i.style("width"))/s[2];t.pos[0]=t.pos[0]*o,t.pos[1]=t.pos[1]*o}}var u=t.pos[0]+(r.offsetLeft||0),l=t.pos[1]+(r.offsetTop||0),c=p.tickFormat()(h.x()(t.point,t.pointIndex)),v=d.tickFormat()(h.y()(t.point,t.pointIndex)),m=f(t.series.key,c,v,t,e);n.tooltip.show([u,l],m)};return h.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],m.tooltipShow(e)}),h.dispatch.on("elementMouseout.tooltip",function(e){m.tooltipHide(e)}),m.on("tooltipHide",function(){u&&n.tooltip.cleanup()}),e.dispatch=m,e.legend=v,e.xAxis=p,e.yAxis=d,d3.rebind(e,h,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id","interpolate"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(i=t,e):i},e.height=function(t){return arguments.length?(s=t,e):s},e.color=function(t){return arguments.length?(r=t,v.color(t),e):r},e.showLegend=function(t){return arguments.length?(o=t,e):o},e.tooltips=function(t){return arguments.length?(u=t,e):u},e.tooltipContent=function(t){return arguments.length?(f=t,e):f},e},n.models.linePlusBarChart=function(){function e(c){return c.each(function(m){var x=d3.select(this),T=this,N=(r||parseInt(x.style("width"))||960)-t.left-t.right,C=(i||parseInt(x.style("height"))||400)-t.top-t.bottom,L=m.filter(function(e){return!e.disabled&&e.bar}),A=m.filter(function(e){return!e.disabled&&!e.bar}),O=m.filter(function(e){return!e.disabled&&e.bar}).map(function(e){return e.values.map(function(e,t){return{x:s(e,t),y:o(e,t)}})}),M=m.filter(function(e){return!e.disabled&&!e.bar}).map(function(e){return e.values.map(function(e,t){return{x:s(e,t),y:o(e,t)}})});d.domain(d3.extent(d3.merge(O.concat(M)),function(e){return e.x})).range([0,N]);var _=d3.select(this).selectAll("g.wrap.linePlusBar").data([m]),D=_.enter().append("g").attr("class","wrap nvd3 linePlusBar").append("g");D.append("g").attr("class","x axis"),D.append("g").attr("class","y1 axis"),D.append("g").attr("class","y2 axis"),D.append("g").attr("class","barsWrap"),D.append("g").attr("class","linesWrap"),D.append("g").attr("class","legendWrap");var P=_.select("g");f&&(w.width(N/2),P.select(".legendWrap").datum(m.map(function(e){return e.originalKey=e.originalKey===undefined?e.key:e.originalKey,e.key=e.originalKey+(e.bar?" (left axis)":" (right axis)"),e})).call(w),t.top!=w.height()&&(t.top=w.height(),C=(i||parseInt(x.style("height"))||400)-t.top-t.bottom),P.select(".legendWrap").attr("transform","translate("+N/2+","+ -t.top+")")),h.width(N).height(C).color(m.map(function(e,t){return e.color||u[t%u.length]}).filter(function(e,t){return!m[t].disabled&&!m[t].bar})),p.width(N).height(C).color(m.map(function(e,t){return e.color||u[t%u.length]}).filter(function(e,t){return!m[t].disabled&&m[t].bar}));var H=P.select(".barsWrap").datum(L.length?L:[{values:[]}]),B=P.select(".linesWrap").datum(A.length?A:[{values:[]}]);d3.transition(H).call(p),d3.transition(B).call(h),P.attr("transform","translate("+t.left+","+t.top+")"),g.ticks(N/100).tickSize(-C,0),P.select(".x.axis").attr("transform","translate(0,"+v.range()[0]+")"),d3.transition(P.select(".x.axis")).call(g),y.ticks(C/36).tickSize(-N,0),d3.transition(P.select(".y1.axis")).style("opacity",L.length?1:0).call(y),b.ticks(C/36).tickSize(L.length?0:-N,0),P.select(".y2.axis").style("opacity",A.length?1:0).attr("transform","translate("+d.range()[1]+",0)"),d3.transition(P.select(".y2.axis")).call(b),w.dispatch.on("legendClick",function(t,n){t.disabled=!t.disabled,m.filter(function(e){return!e.disabled}).length||m.map(function(e){return e.disabled=!1,_.selectAll(".series").classed("disabled",!1),e}),c.transition().call(e)}),h.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],E.tooltipShow(e)}),l&&E.on("tooltipShow",function(e){S(e,T.parentNode)}),h.dispatch.on("elementMouseout.tooltip",function(e){E.tooltipHide(e)}),l&&E.on("tooltipHide",n.tooltip.cleanup),p.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],E.tooltipShow(e)}),l&&E.on("tooltipShow",function(e){S(e,T.parentNode)}),p.dispatch.on("elementMouseout.tooltip",function(e){E.tooltipHide(e)}),l&&E.on("tooltipHide",n.tooltip.cleanup),e.update=function(){c.transition().call(e)},e.container=this}),e}var t={top:30,right:60,bottom:50,left:60},r=null,i=null,s=function(e){return e.x},o=function(e){return e.y},u=d3.scale.category20().range(),f=!0,l=!0,c=function(e,t,n,r,i){return"<h3>"+e+"</h3>"+"<p>"+n+" at "+t+"</p>"},h=n.models.line(),p=n.models.historicalBar(),d=d3.scale.linear(),v=p.yScale(),m=h.yScale(),g=n.models.axis().scale(d).orient("bottom").tickPadding(5),y=n.models.axis().scale(v).orient("left"),b=n.models.axis().scale(m).orient("right"),w=n.models.legend().height(30),E=d3.dispatch("tooltipShow","tooltipHide"),S=function(t,r){var i=t.pos[0]+(r.offsetLeft||0),s=t.pos[1]+(r.offsetTop||0),o=g.tickFormat()(h.x()(t.point,t.pointIndex)),u=(t.series.bar?y:b).tickFormat()(h.y()(t.point,t.pointIndex)),f=c(t.series.key,o,u,t,e);n.tooltip.show([i,s],f,t.value<0?"n":"s")};return e.dispatch=E,e.legend=w,e.lines=h,e.bars=p,e.xAxis=g,e.yAxis1=y,e.yAxis2=b,d3.rebind(e,h,"defined","size","clipVoronoi","interpolate"),e.x=function(t){return arguments.length?(s=t,h.x(t),p.x(t),e):s},e.y=function(t){return arguments.length?(o=t,h.y(t),p.y(t),e):o},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(u=t,w.color(t),e):u},e.showLegend=function(t){return arguments.length?(f=t,e):f},e.tooltips=function(t){return arguments.length?(l=t,e):l},e.tooltipContent=function(t){return arguments.length?(c=t,e):c},e},n.models.lineWithFocusChart=function(){function e(c){return c.each(function(C){function L(){var e=T.empty()?g.domain():d3.extent(d3.merge(C.filter(function(e){return!e.disabled}).map(function(e){return e.values})).filter(function(e){return h.x()(e)>=T.extent()[0]&&h.x()(e)<=T.extent()[1]}),h.y());typeof e[0]=="undefined"&&(e=g.domain()),d.domain(T.empty()?m.domain():T.extent()),v.domain(e),h.xDomain(d.domain()),h.yDomain(v.domain())}function A(){L(),z.call(h),U.select(".focus .x.axis").call(y),U.select(".focus .y.axis").call(b)}function O(e){var t=+(e=="e"),n=t?1:-1,r=H/3;return"M"+.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+.5*n+","+2*r+"Z"+"M"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}var M=d3.select(this),_=this,D=(s||parseInt(M.style("width"))||960)-t.left-t.right,P=(o||parseInt(M.style("height"))||400)-t.top-t.bottom-u,H=u-r.top-r.bottom;T.on("brush",A);var B=M.selectAll("g.wrap.lineWithFocusChart").data([C]),F=B.enter().append("g").attr("class","wrap nvd3 lineWithFocusChart").append("g"),I=F.append("g").attr("class","focus");I.append("g").attr("class","x axis"),I.append("g").attr("class","y axis"),I.append("g").attr("class","linesWrap");var R=F.append("g").attr("class","context");R.append("g").attr("class","x axis"),R.append("g").attr("class","y axis"),R.append("g").attr("class","linesWrap"),R.append("g").attr("class","x brush"),F.append("g").attr("class","legendWrap");var U=B.select("g");f&&(S.width(D),U.select(".legendWrap").datum(C).call(S),t.top!=S.height()&&(t.top=S.height(),P=(o||parseInt(M.style("height"))||400)-t.top-t.bottom),U.select(".legendWrap").attr("transform","translate(0,"+ -t.top+")")),h.width(D).height(P).color(C.map(function(e,t){return e.color||i[t%i.length]}).filter(function(e,t){return!C[t].disabled})),p.defined(h.defined()).width(D).height(H).x(h.x()).y(h.y()).color(C.map(function(e,t){return e.color||i[t%i.length]}).filter(function(e,t){return!C[t].disabled})),U.attr("transform","translate("+t.left+","+t.top+")");var z=U.select(".focus .linesWrap").datum(C.filter(function(e){return!e.disabled}));d3.transition(z).call(h),y.ticks(D/100).tickSize(-P,0),U.select(".focus .x.axis").attr("transform","translate(0,"+v.range()[0]+")"),d3.transition(U.select(".focus .x.axis")).call(y),b.ticks(P/36).tickSize(-D,0),d3.transition(U.select(".focus .y.axis")).call(b),U.select(".context").attr("transform","translate(0,"+(P+t.bottom+r.top)+")");var W=U.select(".context .linesWrap").datum(C.filter(function(e){return!e.disabled}));d3.transition(W).call(p),gBrush=U.select(".x.brush").call(T),gBrush.selectAll("rect").attr("height",H),gBrush.selectAll(".resize").append("path").attr("d",O),w.ticks(D/100).tickSize(-H,0),U.select(".context .x.axis").attr("transform","translate(0,"+g.range()[0]+")"),d3.transition(U.select(".context .x.axis")).call(w),E.ticks(H/36).tickSize(-D,0),d3.transition(U.select(".context .y.axis")).call(E),L(),S.dispatch.on("legendClick",function(t,n){t.disabled=!t.disabled,C.filter(function(e){return!e.disabled}).length||C.map(function(e){return e.disabled=!1,B.selectAll(".series").classed("disabled",!1),e}),c.transition().call(e)}),h.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],x.tooltipShow(e)}),l&&x.on("tooltipShow",function(e){N(e,_.parentNode)}),h.dispatch.on("elementMouseout.tooltip",function(e){x.tooltipHide(e)}),l&&x.on("tooltipHide",n.tooltip.cleanup)}),e.update=function(){e(c)},e.container=this,e}var t={top:30,right:20,bottom:50,left:60},r={top:0,right:20,bottom:20,left:60},i=d3.scale.category20().range(),s=null,o=null,u=100,f=!0,l=!0,c=function(e,t,n,r,i){return"<h3>"+e+"</h3>"+"<p>"+n+" at "+t+"</p>"},h=n.models.line().clipEdge(!0),p=n.models.line().interactive(!1),d=h.xScale(),v=h.yScale(),m=p.xScale(),g=p.yScale(),y=n.models.axis().scale(d).orient("bottom").tickPadding(5),b=n.models.axis().scale(v).orient("left"),w=n.models.axis().scale(d).orient("bottom").tickPadding(5),E=n.models.axis().scale(g).orient("left"),S=n.models.legend().height(30),x=d3.dispatch("tooltipShow","tooltipHide"),T=d3.svg.brush().x(m),N=function(t,r){var i=t.pos[0]+(r.offsetLeft||0),s=t.pos[1]+(r.offsetTop||0),o=y.tickFormat()(h.x()(t.point,t.pointIndex)),u=b.tickFormat()(h.y()(t.point,t.pointIndex)),f=c(t.series.key,o,u,t,e);n.tooltip.show([i,s],f)};return e.dispatch=x,e.legend=S,e.xAxis=y,e.yAxis=b,e.x2Axis=w,e.y2Axis=E,d3.rebind(e,h,"defined","isArea","x","y","size","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(s=t,e):s},e.height=function(t){return arguments.length?(o=t,e):o},e.color=function(t){return arguments.length?(i=t,S.color(t),e):i},e.showLegend=function(t){return arguments.length?(f=t,e):f},e.tooltips=function(t){return arguments.length?(l=t,e):l},e.tooltipContent=function(t){return arguments.length?(c=t,e):c},e.interpolate=function(t){return arguments.length?(h.interpolate(t),p.interpolate(t),e):h.interpolate()},e},n.models.multiBar=function(){function e(E){return E.each(function(S){var x=r-t.left-t.right,T=i-t.top-t.bottom;p&&(S=d3.layout.stack().offset("zero").values(function(e){return e.values}).y(l)(S)),S=S.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e});var N=m&&g?[]:S.map(function(e){return e.values.map(function(e,t){return{x:f(e,t),y:l(e,t),y0:e.y0}})});s.domain(d3.merge(N).map(function(e){return e.x})).rangeBands([0,x],.1),o.domain(g||d3.extent(d3.merge(N).map(function(e){return e.y+(p?e.y0:0)}).concat(c))).range([T,0]);if(s.domain()[0]===s.domain()[1]||o.domain()[0]===o.domain()[1])singlePoint=!0;s.domain()[0]===s.domain()[1]&&(s.domain()[0]?s.domain([s.domain()[0]-s.domain()[0]*.01,s.domain()[1]+s.domain()[1]*.01]):s.domain([-1,1])),n.log(o.domain()),o.domain()[0]===o.domain()[1]&&(o.domain()[0]?o.domain([o.domain()[0]+o.domain()[0]*.01,o.domain()[1]-o.domain()[1]*.01]):o.domain([-1,1])),b=b||s,w=w||o;var C=d3.select(this).selectAll("g.wrap.multibar").data([S]),L=C.enter().append("g").attr("class","wrap nvd3 multibar"),A=L.append("defs"),O=L.append("g");O.append("g").attr("class","groups");var M=C.select("g");C.attr("transform","translate("+t.left+","+t.top+")"),A.append("clipPath").attr("id","edge-clip-"+u).append("rect"),C.select("#edge-clip-"+u+" rect").attr("width",x).attr("height",T),M.attr("clip-path",h?"url(#edge-clip-"+u+")":"");var _=C.select(".groups").selectAll(".group").data(function(e){return e},function(e){return e.key});_.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),d3.transition(_.exit()).selectAll("rect.bar").delay(function(e,t){return t*v/S[0].values.length}).attr("y",function(e){return p?w(e.y0):w(0)}).attr("height",0).remove(),_.attr("class",function(e,t){return"group series-"+t}).classed("hover",function(e){return e.hover}).style("fill",function(e,t){return d[t%d.length]}).style("stroke",function(e,t){return d[t%d.length]}),d3.transition(_).style("stroke-opacity",1).style("fill-opacity",.75);var D=_.selectAll("rect.bar").data(function(e){return e.values});D.exit().remove();var P=D.enter().append("rect").attr("class",function(e,t){return l(e,t)<0?"bar negative":"bar positive"}).attr("x",function(e,t,n){return p?0:n*s.rangeBand()/S.length}).attr("y",function(e){return w(p?e.y0:0)}).attr("height",0).attr("width",s.rangeBand()/(p?1:S.length));D.on("mouseover",function(e,t){d3.select(this).classed("hover",!0),y.elementMouseover({value:l(e,t),point:e,series:S[e.series],pos:[s(f(e,t))+s.rangeBand()*(p?S.length/2:e.series+.5)/S.length,o(l(e,t)+(p?e.y0:0))],pointIndex:t,seriesIndex:e.series,e:d3.event})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),y.elementMouseout({value:l(e,t),point:e,series:S[e.series],pointIndex:t,seriesIndex:e.series,e:d3.event})}).on("click",function(e,t){y.elementClick({value:l(e,t),point:e,series:S[e.series],pos:[s(f(e,t))+s.rangeBand()*(p?S.length/2:e.series+.5)/S.length,o(l(e,t)+(p?e.y0:0))],pointIndex:t,seriesIndex:e.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(e,t){y.elementDblClick({value:l(e,t),point:e,series:S[e.series],pos:[s(f(e,t))+s.rangeBand()*(p?S.length/2:e.series+.5)/S.length,o(l(e,t)+(p?e.y0:0))],pointIndex:t,seriesIndex:e.series,e:d3.event}),d3.event.stopPropagation()}),D.attr("class",function(e,t){return l(e,t)<0?"bar negative":"bar positive"}).attr("transform",function(e,t){return"translate("+s(f(e,t))+",0)"}),p?d3.transition(D).delay(function(e,t){return t*v/S[0].values.length}).attr("y",function(e,t){return o(l(e,t)+(p?e.y0:0))}).attr("height",function(e,t){return Math.abs(o(e.y+(p?e.y0:0))-o(p?e.y0:0))}).each("end",function(){d3.transition(d3.select(this)).attr("x",function(e,t){return p?0:e.series*s.rangeBand()/S.length}).attr("width",s.rangeBand()/(p?1:S.length))}):d3.transition(D).delay(function(e,t){return t*v/S[0].values.length}).attr("x",function(e,t){return e.series*s.rangeBand()/S.length}).attr("width",s.rangeBand()/S.length).each("end",function(){d3.transition(d3.select(this)).attr("y",function(e,t){return l(e,t)<0?o(0):o(l(e,t))}).attr("height",function(e,t){return Math.abs(o(l(e,t))-o(0))})}),e.update=function(){e(E)},b=s.copy(),w=o.copy()}),e}var t={top:0,right:0,bottom:0,left:0},r=960,i=500,s=d3.scale.ordinal(),o=d3.scale.linear(),u=Math.floor(Math.random()*1e4),f=function(e){return e.x},l=function(e){return e.y},c=[0],h=!0,p=!1,d=d3.scale.category20().range(),v=1200,m,g,y=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),b,w;return e.dispatch=y,e.x=function(t){return arguments.length?(f=t,e):f},e.y=function(t){return arguments.length?(l=t,e):l},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.xScale=function(t){return arguments.length?(s=t,e):s},e.yScale=function(t){return arguments.length?(o=t,e):o},e.xDomain=function(t){return arguments.length?(m=t,e):m},e.yDomain=function(t){return arguments.length?(g=t,e):g},e.forceY=function(t){return arguments.length?(c=t,e):c},e.stacked=function(t){return arguments.length?(p=t,e):p},e.clipEdge=function(t){return arguments.length?(h=t,e):h},e.color=function(t){return arguments.length?(d=t,e):d},e.id=function(t){return arguments.length?(u=t,e):u},e.delay=function(t){return arguments.length?(v=t,e):v},e},n.models.multiBarChart=function(){function e(n){return n.each(function(c){var E=d3.select(this),S=this,x=(r||parseInt(E.style("width"))||960)-t.left-t.right,T=(i||parseInt(E.style("height"))||400)-t.top-t.bottom;h=d.xScale(),p=d.yScale();var N=E.selectAll("g.wrap.multiBarWithLegend").data([c]),C=N.enter().append("g").attr("class","wrap nvd3 multiBarWithLegend").append("g");C.append("g").attr("class","x axis"),C.append("g").attr("class","y axis"),C.append("g").attr("class","barsWrap"),C.append("g").attr("class","legendWrap"),C.append("g").attr("class","controlsWrap");var L=N.select("g");u&&(g.width(x/2),L.select(".legendWrap").datum(c).call(g),t.top!=g.height()&&(t.top=g.height(),T=(i||parseInt(E.style("height"))||400)-t.top-t.bottom),L.select(".legendWrap").attr("transform","translate("+x/2+","+ -t.top+")")),d.width(x).height(T).color(c.map(function(e,t){return e.color||s[t%s.length]}).filter(function(e,t){return!c[t].disabled}));if(o){var A=[{key:"Grouped",disabled:d.stacked()},{key:"Stacked",disabled:!d.stacked()}];y.width(180).color(["#444","#444","#444"]),L.select(".controlsWrap").datum(A).attr("transform","translate(0,"+ -t.top+")").call(y)}L.attr("transform","translate("+t.left+","+t.top+")");var O=L.select(".barsWrap").datum(c.filter(function(e){return!e.disabled}));d3.transition(O).call(d),v.scale(h).ticks(x/100).tickSize(-T,0),L.select(".x.axis").attr("transform","translate(0,"+p.range()[0]+")"),d3.transition(L.select(".x.axis")).call(v);var M=L.select(".x.axis > g").selectAll("g");M.selectAll("line, text").style("opacity",1),f&&M.filter(function(e,t){return t%Math.ceil(c[0].values.length/(x/100))!==0}).selectAll("text, line").style("opacity",0),m.scale(p).ticks(T/36).tickSize(-x,0),d3.transition(L.select(".y.axis")).call(m),g.dispatch.on("legendClick",function(t,r){t.disabled=!t.disabled,c.filter(function(e){return!e.disabled}).length||c.map(function(e){return e.disabled=!1,N.selectAll(".series").classed("disabled",!1),e}),n.transition().call(e)}),y.dispatch.on("legendClick",function(t,r){if(!!t.disabled){A=A.map(function(e){return e.disabled=!0,e}),t.disabled=!1;switch(t.key){case"Grouped":d.stacked(!1);break;case"Stacked":d.stacked(!0)}n.transition().call(e)}}),b.on("tooltipShow",function(e){l&&w(e,S.parentNode)}),e.update=function(){n.transition().call(e)},e.container=this}),e}var t={top:30,right:20,bottom:50,left:60},r=null,i=null,s=d3.scale.category20().range(),o=!0,u=!0,f=!0,l=!0,c=function(e,t,n,r,i){return"<h3>"+e+"</h3>"+"<p>"+n+" on "+t+"</p>"},h,p,d=n.models.multiBar().stacked(!1),v=n.models.axis().orient("bottom").highlightZero(!1).showMaxMin(!1),m=n.models.axis().orient("left"),g=n.models.legend().height(30),y=n.models.legend().height(30),b=d3.dispatch("tooltipShow","tooltipHide");v.tickFormat(function(e){return e}),m.tickFormat(d3.format(",.1f"));var w=function(t,r){var i=t.pos[0]+(r.offsetLeft||0),s=t.pos[1]+(r.offsetTop||0),o=v.tickFormat()(d.x()(t.point,t.pointIndex)),u=m.tickFormat()(d.y()(t.point,t.pointIndex)),f=c(t.series.key,o,u,t,e);n.tooltip.show([i,s],f,t.value<0?"n":"s")};return d.dispatch.on("elementMouseover.tooltip2",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],b.tooltipShow(e)}),d.dispatch.on("elementMouseout.tooltip",function(e){b.tooltipHide(e)}),b.on("tooltipHide",function(){l&&n.tooltip.cleanup()}),e.dispatch=b,e.legend=g,e.xAxis=v,e.yAxis=m,d3.rebind(e,d,"x","y","xDomain","yDomain","forceX","forceY","clipEdge","id","stacked","delay"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(s=t,g.color(t),e):s},e.showControls=function(t){return arguments.length?(o=t,e):o},e.showLegend=function(t){return arguments.length?(u=t,e):u},e.reduceXTicks=function(t){return arguments.length?(f=t,e):f},e.tooltips=function(t){return arguments.length?(l=t,e):l},e.tooltipContent=function(t){return arguments.length?(c=t,e):c},e},n.models.multiBarHorizontal=function(){function e(i){return i.each(function(v){var E=n-t.left-t.right,S=r-t.top-t.bottom;c&&(v=d3.layout.stack().offset("zero").values(function(e){return e.values}).y(a)(v)),v=v.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e});var x=m&&g?[]:v.map(function(e){return e.values.map(function(e,t){return{x:u(e,t),y:a(e,t),y0:e.y0}})});s.domain(m||d3.merge(x).map(function(e){return e.x})).rangeBands([0,S],.1),o.domain(g||d3.extent(d3.merge(x).map(function(e){return e.y+(c?e.y0:0)}).concat(f))),h&&!c?o.range([o.domain()[0]<0?p:0,E-(o.domain()[1]>0?p:0)]):o.range([0,E]),y=y||s,b=b||d3.scale.linear().domain(o.domain()).range([o(0),o(0)]);var T=d3.select(this).selectAll("g.wrap.multibarHorizontal").data([v]),N=T.enter().append("g").attr("class","wrap nvd3 multibarHorizontal"),C=N.append("defs"),L=N.append("g");L.append("g").attr("class","groups");var A=T.select("g");T.attr("transform","translate("+t.left+","+t.top+")");var O=T.select(".groups").selectAll(".group").data(function(e){return e},function(e){return e.key});O.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),d3.transition(O.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),O.attr("class",function(e,t){return"group series-"+t}).classed("hover",function(e){return e.hover}).style("fill",function(e,t){return l[t%l.length]}).style("stroke",function(e,t){return l[t%l.length]}),d3.transition(O).style("stroke-opacity",1).style("fill-opacity",.75);var M=O.selectAll("g.bar").data(function(e){return e.values});M.exit().remove();var _=M.enter().append("g").attr("transform",function(e,t,n){return"translate("+b(c?e.y0:0)+","+(c?0:n*s.rangeBand()/v.length+s(u(e,t)))+")"});_.append("rect").attr("width",0).attr("height",s.rangeBand()/(c?1:v.length)),M.on("mouseover",function(e,t){d3.select(this).classed("hover",!0),w.elementMouseover({value:a(e,t),point:e,series:v[e.series],pos:[o(a(e,t)+(c?e.y0:0)),s(u(e,t))+s.rangeBand()*(c?v.length/2:e.series+.5)/v.length],pointIndex:t,seriesIndex:e.series,e:d3.event})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),w.elementMouseout({value:a(e,t),point:e,series:v[e.series],pointIndex:t,seriesIndex:e.series,e:d3.event})}).on("click",function(e,t){w.elementClick({value:a(e,t),point:e,series:v[e.series],pos:[s(u(e,t))+s.rangeBand()*(c?v.length/2:e.series+.5)/v.length,o(a(e,t)+(c?e.y0:0))],pointIndex:t,seriesIndex:e.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(e,t){w.elementDblClick({value:a(e,t),point:e,series:v[e.series],pos:[s(u(e,t))+s.rangeBand()*(c?v.length/2:e.series+.5)/v.length,o(a(e,t)+(c?e.y0:0))],pointIndex:t,seriesIndex:e.series,e:d3.event}),d3.event.stopPropagation()}),h&&!c?(_.append("text").attr("text-anchor",function(e,t){return a(e,t)<0?"end":"start"}),M.select("text").attr("y",s.rangeBand()/2).attr("dy","-.32em").text(function(e,t){return d(a(e,t))}),d3.transition(M).select("text").attr("x",function(e,t){return a(e,t)<0?-4:o(a(e,t))-o(0)+4})):M.selectAll("text").remove(),M.attr("class",function(e,t){return a(e,t)<0?"bar negative":"bar positive"}),c?d3.transition(M).attr("transform",function(e,t){return"translate("+o(e.y0)+","+(c?0:j*s.rangeBand()/v.length)+")"}).select("rect").attr("width",function(e,t){return Math.abs(o(a(e,t)+e.y0)-o(e.y0))}).attr("height",s.rangeBand()):d3.transition(M).attr("transform",function(e,t){return"translate("+(a(e,t)<0?o(a(e,t)):o(0))+","+(e.series*s.rangeBand()/v.length+s(u(e,t)))+")"}).select("rect").attr("height",s.rangeBand()/v.length).attr("width",function(e,t){return Math.abs(o(a(e,t))-o(0))}),e.update=function(){i.transition().call(e)},y=s.copy(),b=o.copy()}),e}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*1e4),s=d3.scale.ordinal(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=[0],l=d3.scale.category20().range(),c=!1,h=!1,p=60,d=d3.format(",.2f"),v=1200,m,g,y,b,w=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return e.dispatch=w,e.x=function(t){return arguments.length?(u=t,e):u},e.y=function(t){return arguments.length?(a=t,e):a},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.xScale=function(t){return arguments.length?(s=t,e):s},e.yScale=function(t){return arguments.length?(o=t,e):o},e.xDomain=function(t){return arguments.length?(m=t,e):m},e.yDomain=function(t){return arguments.length?(g=t,e):g},e.forceY=function(t){return arguments.length?(f=t,e):f},e.stacked=function(t){return arguments.length?(c=t,e):c},e.color=function(t){return arguments.length?(l=t,e):l},e.id=function(t){return arguments.length?(i=t,e):i},e.delay=function(t){return arguments.length?(v=t,e):v},e.showValues=function(t){return arguments.length?(h=t,e):h},e.valueFormat=function(t){return arguments.length?(d=t,e):d},e.valuePadding=function(t){return arguments.length?(p=t,e):p},e},n.models.multiBarHorizontalChart=function(){function e(l){return l.each(function(h){var p=d3.select(this),E=this,S=(r||parseInt(p.style("width"))||960)-t.left-t.right,x=(i||parseInt(p.style("height"))||400)-t.top-t.bottom,T=p.selectAll("g.wrap.multiBarHorizontalChart").data([h]),N=T.enter().append("g").attr("class","wrap nvd3 multiBarHorizontalChart").append("g");N.append("g").attr("class","x axis"),N.append("g").attr("class","y axis"),N.append("g").attr("class","barsWrap"),N.append("g").attr("class","legendWrap"),N.append("g").attr("class","controlsWrap"),t.top=m.height();var C=T.select("g");u&&(m.width(S/2),C.select(".legendWrap").datum(h).call(m),t.top!=m.height()&&(t.top=m.height(),x=(i||parseInt(p.style("height"))||400)-t.top-t.bottom),C.select(".legendWrap").attr("transform","translate("+S/2+","+ -t.top+")")),c.width(S).height(x).color(h.map(function(e,t){return e.color||s[t%s.length]}).filter(function(e,t){return!h[t].disabled})),o&&(g.width(180).color(["#444","#444","#444"]),C.select(".controlsWrap").datum(w).attr("transform","translate(0,"+ -t.top+")").call(g)),C.attr("transform","translate("+t.left+","+t.top+")");var k=C.select(".barsWrap").datum(h.filter(function(e){return!e.disabled}));d3.transition(k).call(c),d.ticks(x/24).tickSize(-S,0),C.select(".x.axis").transition().duration(0).call(d);var L=C.select(".x.axis").selectAll("g");L.selectAll("line, text").style("opacity",1),v.ticks(S/100).tickSize(-x,0),C.select(".y.axis").attr("transform","translate(0,"+x+")"),d3.transition(C.select(".y.axis")).call(v),m.dispatch.on("legendClick",function(t,n){t.disabled=!t.disabled,h.filter(function(e){return!e.disabled}).length||h.map(function(e){return e.disabled=!1,T.selectAll(".series").classed("disabled",!1),e}),l.transition().call(e)}),g.dispatch.on("legendClick",function(t,n){if(!!t.disabled){w=w.map(function(e){return e.disabled=!0,e}),t.disabled=!1;switch(t.key){case"Grouped":c.stacked(!1);break;case"Stacked":c.stacked(!0)}l.transition().call(e)}}),c.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],y.tooltipShow(e)}),f&&y.on("tooltipShow",function(e){b(e,E.parentNode)}),c.dispatch.on("elementMouseout.tooltip",function(e){y.tooltipHide(e)}),f&&y.on("tooltipHide",n.tooltip.cleanup),e.update=function(){l.transition().call(e)},e.container=this}),e}var t={top:30,right:20,bottom:50,left:60},r=null,i=null,s=d3.scale.category20().range(),o=!0,u=!0,f=!0,l=function(e,t,n,r,i){return"<h3>"+e+" - "+t+"</h3>"+"<p>"+n+"</p>"},c=n.models.multiBarHorizontal().stacked(!1),h=c.xScale(),p=c.yScale(),d=n.models.axis().scale(h).orient("left").highlightZero(!1).showMaxMin(!1),v=n.models.axis().scale(p).orient("bottom"),m=n.models.legend().height(30),g=n.models.legend().height(30),y=d3.dispatch("tooltipShow","tooltipHide");d.tickFormat(function(e){return e}),v.tickFormat(d3.format(",.1f"));var b=function(t,r){var i=t.pos[0]+(r.offsetLeft||0),s=t.pos[1]+(r.offsetTop||0),o=d.tickFormat()(c.x()(t.point,t.pointIndex)),u=v.tickFormat()(c.y()(t.point,t.pointIndex)),f=l(t.series.key,o,u,t,e);n.tooltip.show([i,s],f,t.value<0?"e":"w")},w=[{key:"Grouped"},{key:"Stacked",disabled:!0}];return e.dispatch=y,e.multibar=c,e.legend=m,e.xAxis=d,e.yAxis=v,d3.rebind(e,c,"x","y","xDomain","yDomain","forceX","forceY","clipEdge","id","delay","showValues","valueFormat"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(s=t,m.color(t),e):s},e.showControls=function(t){return arguments.length?(o=t,e):o},e.showLegend=function(t){return arguments.length?(u=t,e):u},e.tooltips=function(t){return arguments.length?(f=t,e):f},e.tooltipContent=function(t){return arguments.length?(l=t,e):l},e},n.models.ohlcBar=function(){function e(d){return d.each(function(e){var d=n-t.left-t.right,b=r-t.top-t.bottom;g.domain(v||d3.extent(e[0].values.map(s).concat(c))).range([0,d]),y.domain(m||[d3.min(e[0].values.map(l).concat(h)),d3.max(e[0].values.map(f).concat(h))]).range([b,0]);if(g.domain()[0]===g.domain()[1]||y.domain()[0]===y.domain()[1])singlePoint=!0;g.domain()[0]===g.domain()[1]&&(g.domain()[0]?g.domain([g.domain()[0]-g.domain()[0]*.01,g.domain()[1]+g.domain()[1]*.01]):g.domain([-1,1])),y.domain()[0]===y.domain()[1]&&(y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*.01,y.domain()[1]-y.domain()[1]*.01]):y.domain([-1,1]));var w=d3.select(this).on("click",function(e,t){E.chartClick({data:e,index:t,pos:d3.event,id:i})}),S=d3.select(this).selectAll("g.wrap.historicalStock").data([e[0].values]),x=S.enter().append("g").attr("class","wrap nvd3 historicalStock"),T=x.append("g");T.append("g").attr("class","ticks"),S.attr("width",n).attr("height",r);var N=S.select("g").attr("transform","translate("+t.left+","+t.top+")");x.append("defs").append("clipPath").attr("id","chart-clip-path-"+i).append("rect"),S.select("#chart-clip-path-"+i+" rect").attr("width",d).attr("height",b),T.attr("clip-path",p?"url(#chart-clip-path-"+i+")":"");var C=T.append("g").attr("class","shiftWrap"),L=S.select(".ticks").selectAll(".tick").data(function(e){return e});L.exit().remove();var A=L.enter().append("path").attr("class",function(e,t){return u(e,t)>a(e,t)?"tick negative":"tick positive"}).on("mouseover",function(t,n){d3.select(this).classed("hover",!0),E.elementMouseover({point:t,series:e[0],pos:[g(s(t,n)),y(o(t,n))],pointIndex:n,seriesIndex:0,e:d3.event})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),E.elementMouseout({point:t,series:e[0],pointIndex:n,seriesIndex:0,e:d3.event})}).on("click",function(e,t){E.elementClick({value:o(e,t),data:e,index:t,pos:[g(s(e,t)),y(o(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()}).on("dblclick",function(e,t){E.elementDblClick({value:o(e,t),data:e,index:t,pos:[g(s(e,t)),y(o(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()});L.attr("class",function(e,t){return u(e,t)>a(e,t)?"tick negative":"tick positive"}).attr("transform",function(e,t){return"translate("+g(s(e,t))+","+y(f(e,t))+")"}).attr("d",function(t,n){var r=d/e[0].values.length*.9;return"m0,0l0,"+(y(u(t,n))-y(f(t,n)))+"l"+ -r/2+",0l"+r/2+",0l0,"+(y(l(t,n))-y(u(t,n)))+"l0,"+(y(a(t,n))-y(l(t,n)))+"l"+r/2+",0l"+ -r/2+",0z"})}),e}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*1e4),s=function(e){return e.x},o=function(e){return e.y},u=function(e){return e.open},a=function(e){return e.close},f=function(e){return e.high},l=function(e){return e.low},c=[],h=[],p=!0,d=d3.scale.category20().range(),v,m,g=d3.scale.linear(),y=d3.scale.linear(),b=d3.svg.axis().scale(g).orient("bottom"),w=d3.svg.axis().scale(y).orient("left"),E=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return e.dispatch=E,e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.open=function(t){return arguments.length?(u=t,e):u},e.close=function(t){return arguments.length?(a=t,e):a},e.high=function(t){return arguments.length?(f=t,e):f},e.low=function(t){return arguments.length?(l=t,e):l},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.xScale=function(t){return arguments.length?(g=t,e):g},e.yScale=function(t){return arguments.length?(y=t,e):y},e.xDomain=function(t){return arguments.length?(v=t,e):v},e.yDomain=function(t){return arguments.length?(m=t,e):m},e.forceX=function(t){return arguments.length?(c=t,e):c},e.forceY=function(t){return arguments.length?(h=t,e):h},e.clipEdge=function(t){return arguments.length?(p=t,e):p},e.color=function(t){return arguments.length?(d=t,e):d},e.id=function(t){return arguments.length?(i=t,e):i},e},n.models.pie=function(){function e(f){return f.each(function(e){function f(e){e.innerRadius=0;var t=d3.interpolate({startAngle:0,endAngle:0},e);return function(e){return A(t(e))}}function v(e){h||(e.innerRadius=0);var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){return A(t(e))}}function y(e){var t=(e.startAngle+e.endAngle)*90/Math.PI-90;return t>90?t-180:t}var w=n-t.left-t.right,E=r-t.top-t.bottom,S=Math.min(w,E)/2,x=d3.select(this).on("click",function(e,t){p.chartClick({data:e,index:t,pos:d3.event,id:u})}),T=x.selectAll(".wrap.pie").data([i(e[0])]),N=T.enter().append("g").attr("class","wrap nvd3 pie chart-"+u),C=N.append("g"),L=T.select("g");C.append("g").attr("class","pie"),T.attr("transform","translate("+t.left+","+t.top+")"),L.select(".pie").attr("transform","translate("+w/2+","+E/2+")");var A=d3.svg.arc().outerRadius(S-S/5);h&&A.innerRadius(S/2);var O=d3.layout.pie().sort(null).value(function(e){return e.disabled?0:o(e)}),M=T.select(".pie").selectAll(".slice").data(O);M.exit().remove();var _=M.enter().append("svg:g").attr("class","slice").on("mouseover",function(e,t){d3.select(this).classed("hover",!0),p.elementMouseover({label:s(e.data),value:o(e.data),point:e.data,pointIndex:t,pos:[d3.event.pageX,d3.event.pageY],id:u})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),p.elementMouseout({label:s(e.data),value:o(e.data),point:e.data,index:t,id:u})}).on("click",function(e,t){p.elementClick({label:s(e.data),value:o(e.data),point:e.data,index:t,pos:d3.event,id:u}),d3.event.stopPropagation()}).on("dblclick",function(e,t){p.elementDblClick({label:s(e.data),value:o(e.data),point:e.data,index:t,pos:d3.event,id:u}),d3.event.stopPropagation()});M.attr("fill",function(e,t){return a[t]}).attr("stroke",function(e,t){return a[t]});var D=_.append("svg:path").each(function(e){this._current=e});d3.transition(M.select("path")).attr("d",A).attrTween("d",v),l&&(_.append("text").attr("transform",function(e){return e.outerRadius=S+10,e.innerRadius=S+15,"translate("+A.centroid(e)+")"}).style("text-anchor","middle").style("fill","#000"),d3.transition(M.select("text")).attr("transform",function(e){return e.outerRadius=S+10,e.innerRadius=S+15,"translate("+A.centroid(e)+")"}).text(function(e,t){var n=(e.endAngle-e.startAngle)/(2*Math.PI);return e.value&&n>c?s(e.data):""}))}),e}var t={top:0,right:0,bottom:0,left:0},n=500,r=500,i=function(e){return e.values},s=function(e){return e.x},o=function(e){return e.y},u=Math.floor(Math.random()*1e4),a=d3.scale.category20().range(),f=d3.format(",.2f"),l=!0,c=.02,h=!1,p=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return e.dispatch=p,e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.values=function(t){return arguments.length?(i=t,e):i},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=d3.functor(t),e):o},e.showLabels=function(t){return arguments.length?(l=t,e):l},e.donut=function(t){return arguments.length?(h=t,e):h},e.id=function(t){return arguments.length?(u=t,e):u},e.color=function(t){return arguments.length?(a=t,e):a},e.valueFormat=function(t){return arguments.length?(f=t,e):f},e.labelThreshold=function(t){return arguments.length?(c=t,e):c},e},n.models.pieChart=function(){function e(o){return o.each(function(f){var v=d3.select(this),y=this,w=(r||parseInt(v.style("width"))||960)-t.left-t.right,E=(i||parseInt(v.style("height"))||400)-t.top-t.bottom,S=v.selectAll("g.wrap.pieChart").data([f]),x=S.enter().append("g").attr("class","wrap nvd3 pieChart").append("g");x.append("g").attr("class","pieWrap"),x.append("g").attr("class","legendWrap");var T=S.select("g");s&&(c.width(w).key(l.x()),S.select(".legendWrap").datum(l.values()(f[0])).call(c),t.top!=c.height()&&(t.top=c.height(),E=(i||parseInt(v.style("height"))||400)-t.top-t.bottom),S.select(".legendWrap").attr("transform","translate(0,"+ -t.top+")")),l.width(w).height(E),T.attr("transform","translate("+t.left+","+t.top+")");var N=T.select(".pieWrap").datum(f);d3.transition(N).call(l),c.dispatch.on("legendClick",function(t,n,r){t.disabled=!t.disabled,l.values()(f[0]).filter(function(e){return!e.disabled}).length||l.values()(f[0]).map(function(e){return e.disabled=!1,S.selectAll(".series").classed("disabled",!1),e}),o.transition().call(e)}),l.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],h.tooltipShow(e)}),u&&h.on("tooltipShow",function(e){p(e)}),l.dispatch.on("elementMouseout.tooltip",function(e){h.tooltipHide(e)}),u&&h.on("tooltipHide",n.tooltip.cleanup),e.update=function(){o.transition().call(e)},e.container=this}),e}var t={top:30,right:20,bottom:20,left:20},r=null,i=null,s=!0,o=d3.scale.category20().range(),u=!0,f=function(e,t,n,r){return"<h3>"+e+"</h3>"+"<p>"+t+"</p>"},l=n.models.pie(),c=n.models.legend().height(30),h=d3.dispatch("tooltipShow","tooltipHide"),p=function(t,r){var i=t.pos[0]+(r&&r.offsetLeft||0),s=t.pos[1]+(r&&r.offsetTop||0),o=l.valueFormat()(l.y()(t.point)),u=f(l.x()(t.point),o,t,e);n.tooltip.show([i,s],u,t.value<0?"n":"s")};return e.dispatch=h,e.pie=l,d3.rebind(e,l,"values","x","y","id","showLabels","donut","labelThreshold"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(o=t,c.color(t),l.color(t),e):o},e.showLegend=function(t){return arguments.length?(s=t,e):s},e.tooltips=function(t){return arguments.length?(u=t,e):u},e.tooltipContent=function(t){return arguments.length?(f=t,e):f},e},n.models.scatter=function(){function e(O){return O.each(function(e){function O(){if(!m)return!1;var n=d3.merge(e.map(function(e,t){return e.values.filter(g).map(function(e,n){return[o(f(e,n))*(Math.random()/1e12+1),u(l(e,n))*(Math.random()/1e12+1),t,n]})}));if(b){I.append("clipPath").attr("id","points-clip-"+s);var r=H.select("#points-clip-"+s).selectAll("circle").data(n);r.enter().append("circle").attr("r",w),r.exit().remove(),r.attr("cx",function(e){return e[0]}).attr("cy",function(e){return e[1]}),H.select(".point-paths").attr("clip-path","url(#points-clip-"+s+")")}var i=d3.geom.voronoi(n).map(function(e,t){return{data:e,series:n[t][2],point:n[t][3]}}),a=H.select(".point-paths").selectAll("path").data(i);a.enter().append("path").attr("class",function(e,t){return"path-"+t}),a.exit().remove(),a.attr("d",function(e){return"M"+e.data.join(",")+"Z"}).on("click",function(n){var r=e[n.series],i=r.values[n.point];N.elementClick({point:i,series:r,pos:[o(f(i,n.point))+t.left,u(l(i,n.point))+t.top],seriesIndex:n.series,pointIndex:n.point})}).on("mouseover",function(n){var r=e[n.series],i=r.values[n.point];N.elementMouseover({point:i,series:r,pos:[o(f(i,n.point))+t.left,u(l(i,n.point))+t.top],seriesIndex:n.series,pointIndex:n.point})}).on("mouseout",function(t,n){var r=e[t.series],i=r.values[t.point];N.elementMouseout({point:i,series:r,seriesIndex:t.series,pointIndex:t.point})})}var M=n-t.left-t.right,_=r-t.top-t.bottom,D=d3.select(this);e=e.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e});var P=E&&S&&x?[]:d3.merge(e.map(function(e){return e.values.map(function(e,t){return{x:f(e,t),y:l(e,t),size:c(e,t)}})}));o.domain(E||d3.extent(P.map(function(e){return e.x}).concat(p))).range([0,M]),u.domain(S||d3.extent(P.map(function(e){return e.y}).concat(d))).range([_,0]),a.domain(x||d3.extent(P.map(function(e){return e.size}).concat(v))).range([16,256]);if(o.domain()[0]===o.domain()[1]||u.domain()[0]===u.domain()[1])T=!0;o.domain()[0]===o.domain()[1]&&(o.domain()[0]?o.domain([o.domain()[0]-o.domain()[0]*.01,o.domain()[1]+o.domain()[1]*.01]):o.domain([-1,1])),u.domain()[0]===u.domain()[1]&&(u.domain()[0]?u.domain([u.domain()[0]+u.domain()[0]*.01,u.domain()[1]-u.domain()[1]*.01]):u.domain([-1,1])),C=C||o,k=k||u,L=L||a;var H=D.selectAll("g.wrap.scatter").data([e]),F=H.enter().append("g").attr("class","wrap nvd3 scatter chart-"+s+(T?" single-point":"")),I=F.append("defs"),R=F.append("g"),U=H.select("g");R.append("g").attr("class","groups"),R.append("g").attr("class","point-paths"),H.attr("transform","translate("+t.left+","+t.top+")"),I.append("clipPath").attr("id","edge-clip-"+s).append("rect"),H.select("#edge-clip-"+s+" rect").attr("width",M).attr("height",_),U.attr("clip-path",y?"url(#edge-clip-"+s+")":"");var W=H.select(".groups").selectAll(".group").data(function(e){return e},function(e){return e.key});W.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),d3.transition(W.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),W.attr("class",function(e,t){return"group series-"+t}).classed("hover",function(e){return e.hover}),d3.transition(W).style("fill",function(e,t){return i[t%i.length]}).style("stroke",function(e,t){return i[t%i.length]}).style("stroke-opacity",1).style("fill-opacity",.5);var X=W.selectAll("path.point").data(function(e){return e.values});X.enter().append("path").attr("transform",function(e,t){return"translate("+C(f(e,t))+","+k(l(e,t))+")"}).attr("d",d3.svg.symbol().type(h).size(function(e,t){return a(c(e,t))})),d3.transition(W.exit().selectAll("path.point")).attr("transform",function(e,t){return"translate("+o(f(e,t))+","+u(l(e,t))+")"}).remove(),X.attr("class",function(e,t){return"point point-"+t}),d3.transition(X).attr("transform",function(e,t){return"translate("+o(f(e,t))+","+u(l(e,t))+")"}).attr("d",d3.svg.symbol().type(h).size(function(e,t){return a(c(e,t))})),clearTimeout(A),A=setTimeout(O,1e3),C=o.copy(),k=u.copy(),L=a.copy()}),e}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=d3.scale.category20().range(),s=Math.floor(Math.random()*1e5),o=d3.scale.linear(),u=d3.scale.linear(),a=d3.scale.linear(),f=function(e){return e.x},l=function(e){return e.y},c=function(e){return e.size},h=function(e){return e.shape||"circle"},p=[],d=[],v=[],m=!0,g=function(e){return!e.notActive},y=!1,b=!0,w=function(){return 25},E=null,S=null,x=null,T=!1,N=d3.dispatch("elementClick","elementMouseover","elementMouseout"),C,k,L,A;return N.on("elementMouseover.point",function(e){m&&d3.select(".chart-"+s+" .series-"+e.seriesIndex+" .point-"+e.pointIndex).classed("hover",!0)}),N.on("elementMouseout.point",function(e){m&&d3.select(".chart-"+s+" .series-"+e.seriesIndex+" .point-"+e.pointIndex).classed("hover",!1)}),e.dispatch=N,e.x=function(t){return arguments.length?(f=d3.functor(t),e):f},e.y=function(t){return arguments.length?(l=d3.functor(t),e):l},e.size=function(t){return arguments.length?(c=d3.functor(t),e):c},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.xScale=function(t){return arguments.length?(o=t,e):o},e.yScale=function(t){return arguments.length?(u=t,e):u},e.zScale=function(t){return arguments.length?(a=t,e):a},e.xDomain=function(t){return arguments.length?(E=t,e):E},e.yDomain=function(t){return arguments.length?(S=t,e):S},e.sizeDomain=function(t){return arguments.length?(x=t,e):x},e.forceX=function(t){return arguments.length?(p=t,e):p},e.forceY=function(t){return arguments.length?(d=t,e):d},e.forceSize=function(t){return arguments.length?(v=t,e):v},e.interactive=function(t){return arguments.length?(m=t,e):m},e.pointActive=function(t){return arguments.length?(g=t,e):g},e.clipEdge=function(t){return arguments.length?(y=t,e):y},e.clipVoronoi=function(t){return arguments.length?(b=t,e):b},e.clipRadius=function(t){return arguments.length?(w=t,e):w},e.color=function(t){return arguments.length?(i=t,e):i},e.shape=function(t){return arguments.length?(h=t,e):h},e.id=function(t){return arguments.length?(s=t,e):s},e.singlePoint=function(t){return arguments.length?(T=t,e):T},e},n.models.scatterChart=function(){function e(n){return n.each(function(f){function l(){if(d)return F.select(".point-paths").style("pointer-events","all"),!1;F.select(".point-paths").style("pointer-events","none");var e=d3.mouse(this);o.distortion(p).focus(e[0]),u.distortion(p).focus(e[1]),F.select(".scatterWrap").datum(f.filter(function(e){return!e.disabled})).call(b),F.select(".x.axis").call(w),F.select(".y.axis").call(E),F.select(".distributionX").datum(f.filter(function(e){return!e.disabled})).call(T),F.select(".distributionY").datum(f.filter(function(e){return!e.disabled})).call(N)}var m=d3.select(this),g=this,y=(r||parseInt(m.style("width"))||960)-t.left-t.right,M=(i||parseInt(m.style("height"))||400)-t.top-t.bottom;o=b.xScale(),u=b.yScale(),k=k||o,L=L||u;var _=m.selectAll("g.wrap.scatterChart").data([f]),P=_.enter().append("g").attr("class","wrap nvd3 scatterChart chart-"+b.id()),H=P.append("g"),F=_.select("g");H.append("rect").attr("class","nvd3 background"),H.append("g").attr("class","x axis"),H.append("g").attr("class","y axis"),H.append("g").attr("class","scatterWrap"),H.append("g").attr("class","distWrap"),H.append("g").attr("class","legendWrap"),H.append("g").attr("class","controlsWrap"),_.attr("transform","translate("+t.left+","+t.top+")"),c&&(S.width(y/2),_.select(".legendWrap").datum(f).call(S),t.top!=S.height()&&(t.top=S.height(),M=(i||parseInt(m.style("height"))||400)-t.top-t.bottom),_.select(".legendWrap").attr("transform","translate("+y/2+","+ -t.top+")")),h&&(x.width(180).color(["#444"]),F.select(".controlsWrap").datum(O).attr("transform","translate(0,"+ -t.top+")").call(x)),F.select(".background").attr("width",y).attr("height",M),b.width(y).height(M).color(f.map(function(e,t){return e.color||s[t%s.length]}).filter(function(e,t){return!f[t].disabled})),_.select(".scatterWrap").datum(f.filter(function(e){return!e.disabled})).call(b),w.scale(o).ticks(y/100).tickSize(-M,0),F.select(".x.axis").attr("transform","translate(0,"+u.range()[0]+")").call(w),E.scale(u).ticks(M/36).tickSize(-y,0),F.select(".y.axis").call(E),T.scale(o).width(y).color(f.map(function(e,t){return e.color||s[t%s.length]}).filter(function(e,t){return!f[t].disabled})),H.select(".distWrap").append("g").attr("class","distributionX").attr("transform","translate(0,"+u.range()[0]+")"),F.select(".distributionX").datum(f.filter(function(e){return!e.disabled})).call(T),N.scale(u).width(M).color(f.map(function(e,t){return e.color||s[t%s.length]}).filter(function(e,t){return!f[t].disabled})),H.select(".distWrap").append("g").attr("class","distributionY").attr("transform","translate(-"+N.size()+",0)"),F.select(".distributionY").datum(f.filter(function(e){return!e.disabled})).call(N),F.select(".background").on("mousemove",l),F.select(".background").on("click",function(){d=!d}),b.dispatch.on("elementClick.freezeFisheye",function(){d=!d}),x.dispatch.on("legendClick",function(t,r){t.disabled=!t.disabled,p=t.disabled?0:2.5,F.select(".background").style("pointer-events",t.disabled?"none":"all"),F.select(".point-paths").style("pointer-events",t.disabled?"all":"none"),t.disabled?(o.distortion(p).focus(0),u.distortion(p).focus(0),F.select(".scatterWrap").call(b),F.select(".x.axis").call(w),F.select(".y.axis").call(E)):d=!1,e(n)}),S.dispatch.on("legendClick",function(t,r,i){t.disabled=!t.disabled,f.filter(function(e){return!e.disabled}).length||f.map(function(e){return e.disabled=!1,_.selectAll(".series").classed("disabled",!1),e}),e(n)}),b.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".chart-"+b.id()+" .series-"+e.seriesIndex+" .distx-"+e.pointIndex).attr("y1",e.pos[1]-M),d3.select(".chart-"+b.id()+" .series-"+e.seriesIndex+" .disty-"+e.pointIndex).attr("x2",e.pos[0]+T.size()),e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],C.tooltipShow(e)}),C.on("tooltipShow",function(e){v&&A(e,g.parentNode)}),k=o.copy(),L=u.copy(),e.update=function(){e(n)},e.container=this}),e}var t={top:30,right:20,bottom:50,left:60},r=null,i=null,s=d3.scale.category20().range(),o=d3.fisheye.scale(d3.scale.linear).distortion(0),u=d3.fisheye.scale(d3.scale.linear).distortion(0),f=!1,l=!1,c=!0,h=!0,p=0,d=!1,v=!0,m=function(e,t,n){return"<strong>"+t+"</strong>"},g=function(e,t,n){return"<strong>"+n+"</strong>"},y=null,b=n.models.scatter().xScale(o).yScale(u),w=n.models.axis().orient("bottom").tickPadding(10),E=n.models.axis().orient("left").tickPadding(10),S=n.models.legend().height(30),x=n.models.legend().height(30),T=n.models.distribution().axis("x"),N=n.models.distribution().axis("y"),C=d3.dispatch("tooltipShow","tooltipHide"),k,L,A=function(r,i){var s=r.pos[0]+(i.offsetLeft||0),f=r.pos[1]+(i.offsetTop||0),l=r.pos[0]+(i.offsetLeft||0),c=u.range()[0]+t.top+(i.offsetTop||0),h=o.range()[0]+t.left+(i.offsetLeft||0),p=r.pos[1]+(i.offsetTop||0),d=w.tickFormat()(b.x()(r.point,r.pointIndex)),v=E.tickFormat()(b.y()(r.point,r.pointIndex));m!=null&&n.tooltip.show([l,c],m(r.series.key,d,v,r,e),"n",1,null,"x-nvtooltip"),g!=null&&n.tooltip.show([h,p],g(r.series.key,d,v,r,e),"e",1,null,"y-nvtooltip"),y!=null&&n.tooltip.show([s,f],y(r.series.key,d,v,r,e),r.value<0?"n":"s")},O=[{key:"Magnify",disabled:!0}];return b.dispatch.on("elementMouseout.tooltip",function(e){C.tooltipHide(e),d3.select(".chart-"+b.id()+" .series-"+e.seriesIndex+" .distx-"+e.pointIndex).attr("y1",0),d3.select(".chart-"+b.id()+" .series-"+e.seriesIndex+" .disty-"+e.pointIndex).attr("x2",N.size())}),C.on("tooltipHide",function(){v&&n.tooltip.cleanup()}),e.dispatch=C,e.legend=S,e.controls=S,e.xAxis=w,e.yAxis=E,e.distX=T,e.distY=N,d3.rebind(e,b,"id","interactive","pointActive","shape","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","clipVoronoi","clipRadius"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.color=function(t){return arguments.length?(s=t,S.color(t),T.color(t),N.color(t),e):s},e.showDistX=function(t){return arguments.length?(f=t,e):f},e.showDistY=function(t){return arguments.length?(l=t,e):l},e.showControls=function(t){return arguments.length?(h=t,e):h},e.showLegend=function(t){return arguments.length?(c=t,e):c},e.fisheye=function(t){return arguments.length?(p=t,e):p},e.tooltips=function(t){return arguments.length?(v=t,e):v},e.tooltipContent=function(t){return arguments.length?(y=t,e):y},e.tooltipXContent=function(t){return arguments.length?(m=t,e):m},e.tooltipYContent=function(t){return arguments.length?(g=t,e):g},e},n.models.sparkline=function(){function e(i){return i.each(function(e){var i=n-t.left-t.right,p=r-t.top-t.bottom;l.domain(a||d3.extent(e,s)).range([0,i]),c.domain(f||d3.extent(e,o)).range([p,0]);var d=d3.select(this).selectAll("g.sparkline").data([e]),v=d.enter().append("g").attr("class","nvd3 sparkline");v.attr("transform","translate("+t.left+","+t.top+")").style("stroke",function(e,t){return e.color||u[t*u.length]});var m=v.selectAll("path").data(function(e){return[e]});m.enter().append("path"),m.exit().remove(),m.attr("d",d3.svg.line().x(function(e,t){return l(s(e,t))}).y(function(e,t){return c(o(e,t))}));var y=v.selectAll("circle.point").data(function(e){return e.filter(function(e,t){return c.domain().indexOf(o(e,t))!=-1||s(e,t)==l.domain()[1]})});y.enter().append("circle").attr("class","point"),y.exit().remove(),y.attr("cx",function(e,t){return l(s(e,t))}).attr("cy",function(e,t){return c(o(e,t))}).attr("r",2).style("stroke",function(e,t){return e.x==l.domain()[1]?"#444":e.y==c.domain()[0]?"#d62728":"#2ca02c"}).style("fill",function(e,t){return e.x==l.domain()[1]?"#444":e.y==c.domain()[0]?"#d62728":"#2ca02c"})}),e}var t={top:0,right:0,bottom:0,left:0},n=400,r=32,i=!0,s=function(e){return e.x},o=function(e){return e.y},u=d3.scale.category20().range(),a,f,l=d3.scale.linear(),c=d3.scale.linear();return e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(n=t,e):n},e.height=function(t){return arguments.length?(r=t,e):r},e.x=function(t){return arguments.length?(s=d3.functor(t),e):s},e.y=function(t){return arguments.length?(o=d3.functor(t),e):o},e.xDomain=function(t){return arguments.length?(a=t,e):a},e.yDomain=function(t){return arguments.length?(f=t,e):f},e.animate=function(t){return arguments.length?(i=t,e):i},e},n.models.sparklinePlus=function(){function e(n){return n.each(function(e){function n(){var n=d3.event.offsetX-t.left;x.attr("x1",n).attr("x2",n),T.attr("transform",function(e){return"translate("+(n-6)+","+ -t.top+")"}).text(c(Math.round(p.invert(n)))),N.attr("transform",function(e){return"translate("+(n+6)+","+ -t.top+")"}).text(h(u(e[Math.round(p.invert(n))])))}var s=r-t.left-t.right,a=i-t.top-t.bottom;p.domain(d3.extent(e,o)).range([0,s]),d.domain(d3.extent(e,u)).range([a,0]);var l=d3.select(this).selectAll("g.sparklineplus").data([e]),y=l.enter().append("g"),w=y.append("g").attr("class","nvd3 sparklineplus").attr("transform","translate("+t.left+","+t.top+")").style("stroke",function(e,t){return e.color||f[t%f.length]});v.xDomain(p.domain()).yDomain(d.domain()),w.call(v);var E=w.append("g").attr("class","hoverValue"),S=w.append("g").attr("class","hoverArea");E.attr("transform",function(e){return"translate("+p(e)+",0)"});var x=E.append("line").attr("x1",p.range()[1]).attr("y1",-t.top).attr("x2",p.range()[1]).attr("y2",i),T=E.append("text").attr("class","xValue").attr("text-anchor","end").attr("dy",".9em"),N=E.append("text").attr("class","yValue").attr("text-anchor","start").attr("dy",".9em");S.append("rect").attr("width",s).attr("height",a).on("mousemove",n)}),e}var t={top:15,right:40,bottom:3,left:40},r=400,i=50,s=!0,o=function(e){return e.x},u=function(e){return e.y},f=d3.scale.category20().range(),l=Math.floor(Math.random()*1e5),c=d3.format(",r"),h=d3.format(",.2f"),p=d3.scale.linear(),d=d3.scale.linear(),v=n.models.sparkline();return e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(n){return arguments.length?(r=n,v.width(n-t.left-t.right),e):r},e.height=function(n){return arguments.length?(i=n,v.height(n-t.top-t.bottom),e):i},e.x=function(t){return arguments.length?(o=d3.functor(t),v.x(t),e):o},e.y=function(t){return arguments.length?(u=d3.functor(t),v.y(t),e):u},e.id=function(t){return arguments.length?(l=t,e):l},e.animate=function(t){return arguments.length?(s=t,e):s},e},n.models.stackedArea=function(){function e(n){return n.each(function(e){var n=r-t.left-t.right,a=i-t.top-t.bottom;d=g.xScale(),v=g.yScale(),e=e.map(function(e,t){return e.values=e.values.map(function(t,n){return t.index=n,t.stackedY=e.disabled?0:f(t,n),t}),e}),e=d3.layout.stack().order(h).offset(c).values(function(e){return e.values}).x(u).y(function(e){return e.stackedY}).out(function(e,t,n){e.display={y:n,y0:t}})(e);var l=d3.select(this).selectAll("g.wrap.stackedarea").data([e]),m=l.enter().append("g").attr("class","wrap nvd3 stackedarea"),w=m.append("defs"),E=m.append("g"),S=l.select("g");E.append("g").attr("class","areaWrap"),g.width(n).height(a).x(u).y(function(e){return e.display.y+e.display.y0}).forceY([0]).color(e.map(function(e,t){return e.color||s[t%s.length]}).filter(function(t,n){return!e[n].disabled})),E.append("g").attr("class","scatterWrap");var x=S.select(".scatterWrap").datum(e.filter(function(e){return!e.disabled}));d3.transition(x).call(g),l.attr("transform","translate("+t.left+","+t.top+")"),w.append("clipPath").attr("id","edge-clip-"+o).append("rect"),l.select("#edge-clip-"+o+" rect").attr("width",n).attr("height",a),S.attr("clip-path",p?"url(#edge-clip-"+o+")":"");var T=d3.svg.area().x(function(e,t){return d(u(e,t))}).y0(function(e){return v(e.display.y0)}).y1(function(e){return v(e.display.y+e.display.y0)}),N=d3.svg.area().x(function(e,t){return d(u(e,t))}).y0(function(e){return v(e.display.y0)}).y1(function(e){return v(e.display.y0)}),C=S.select(".areaWrap").selectAll("path.area").data(function(e){return e});C.enter().append("path").attr("class",function(e,t){return"area area-"+t}).on("mouseover",function(e,t){d3.select(this).classed("hover",!0),y.areaMouseover({point:e,series:e.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),y.areaMouseout({point:e,series:e.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t})}).on("click",function(e,t){d3.select(this).classed("hover",!1),y.areaClick({point:e,series:e.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t})}),d3.transition(C.exit()).attr("d",function(e,t){return N(e.values,t)}).remove(),C.style("fill",function(e,t){return e.color||s[t%s.length]}).style("stroke",function(e,t){return e.color||s[t%s.length]}),d3.transition(C).attr("d",function(e,t){return T(e.values,t)}),g.dispatch.on("elementMouseover.area",function(e){S.select(".chart-"+o+" .area-"+e.seriesIndex).classed("hover",!0)}),g.dispatch.on("elementMouseout.area",function(e){S.select(".chart-"+o+" .area-"+e.seriesIndex).classed("hover",!1)})}),e}var t={top:0,right:0,bottom:0,left:0},r=960,i=500,s=d3.scale.category20().range(),o=Math.floor(Math.random()*1e5),u=function(e){return e.x},f=function(e){return e.y},l="stack",c="zero",h="default",p=!1,d,v,m=d3.layout.stack().values(function(e){return e.values}).x(u).y(function(e){return e.stackedY}).out(function(e,t,n){e.display={y:n,y0:t}}),g=n.models.scatter().size(2.2).sizeDomain([2.5]),y=d3.dispatch("tooltipShow","tooltipHide","areaClick","areaMouseover","areaMouseout");return g.dispatch.on("elementClick.area",function(e){y.areaClick(e)}),g.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],y.tooltipShow(e)}),g.dispatch.on("elementMouseout.tooltip",function(e){y.tooltipHide(e)}),e.dispatch=y,e.scatter=g,d3.rebind(e,g,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","clipVoronoi","clipRadius"),e.x=function(t){return arguments.length?(u=d3.functor(t),e):u},e.y=function(t){return arguments.length?(f=d3.functor(t),e):f},e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(i=t,e):i},e.clipEdge=function(t){return arguments.length?(p=t,e):p},e.color=function(t){return arguments.length?(s=t,e):s},e.offset=function(t){return arguments.length?(c=t,e):c},e.order=function(t){return arguments.length?(h=t,e):h},e.style=function(t){if(!arguments.length)return l;l=t;switch(l){case"stack":e.offset("zero"),e.order("default");break;case"stream":e.offset("wiggle"),e.order("inside-out");break;case"expand":e.offset("expand"),e.order("default")}return e},e},n.models.stackedAreaChart=function(){function e(n){return n.each(function(s){var l=d3.select(this),E=this,S=(r||parseInt(l.style("width"))||960)-t.left-t.right,x=(i||parseInt(l.style("height"))||400)-t.top-t.bottom;c=p.xScale(),h=p.yScale();var T=l.selectAll("g.wrap.stackedAreaChart").data([s]),N=T.enter().append("g").attr("class","wrap nvd3 stackedAreaChart").append("g");N.append("g").attr("class","x axis"),N.append("g").attr("class","y axis"),N.append("g").attr("class","stackedWrap"),N.append("g").attr("class","legendWrap"),N.append("g").attr("class","controlsWrap");var C=T.select("g");u&&(m.width(S/2),C.select(".legendWrap").datum(s).call(m),t.top!=m.height()&&(t.top=m.height(),x=(i||parseInt(l.style("height"))||400)-t.top-t.bottom),C.select(".legendWrap").attr("transform","translate("+S/2+","+ -t.top+")")),p.width(S).height(x),o&&(g.width(280).color(["#444","#444","#444"]),C.select(".controlsWrap").datum(b).attr("transform","translate(0,"+ -t.top+")").call(g)),C.attr("transform","translate("+t.left+","+t.top+")");var L=C.select(".stackedWrap").datum(s);d3.transition(L).call(p),d.scale(c).ticks(S/100).tickSize(-x,0),C.select(".x.axis").attr("transform","translate(0,"+x+")"),d3.transition(C.select(".x.axis")).call(d),v.scale(h).ticks(p.offset()=="wiggle"?0:x/36).tickSize(-S,0).tickFormat(p.offset()=="expand"?d3.format("%"):d3.format(",.2f")),d3.transition(C.select(".y.axis")).call(v),p.dispatch.on("areaClick.toggle",function(t){s.filter(function(e){return!e.disabled}).length===1?s=s.map(function(e){return e.disabled=!1,e}):s=s.map(function(e,n){return e.disabled=n!=t.seriesIndex,e}),n.transition().call(e)}),m.dispatch.on("legendClick",function(t,r){t.disabled=!t.disabled,s.filter(function(e){return!e.disabled}).length||s.map(function(e){return e.disabled=!1,e}),n.transition().call(e)}),g.dispatch.on("legendClick",function(t,r){if(!!t.disabled){b=b.map(function(e){return e.disabled=!0,e}),t.disabled=!1;switch(t.key){case"Stacked":p.style("stack");break;case"Stream":p.style("stream");break;case"Expanded":p.style("expand")}n.transition().call(e)}}),y.on("tooltipShow",function(e){f&&w(e,E.parentNode)})}),e.update=function(){n.transition().call(e)},e.container=this,e}var t={top:30,right:25,bottom:50,left:60},r=null,i=null,s=d3.scale.category20().range(),o=!0,u=!0,f=!0,l=function(e,t,n,r,i){return"<h3>"+e+"</h3>"+"<p>"+n+" on "+t+"</p>"},c,h,p=n.models.stackedArea(),d=n.models.axis().orient("bottom").tickPadding(5),v=n.models.axis().orient("left"),m=n.models.legend().height(30),g=n.models.legend().height(30),y=d3.dispatch("tooltipShow","tooltipHide"),b=[{key:"Stacked"},{key:"Stream",disabled:!0},{key:"Expanded",disabled:!0}],w=function(t,r){var i=t.pos[0]+(r.offsetLeft||0),s=t.pos[1]+(r.offsetTop||0),o=d.tickFormat()(p.x()(t.point,t.pointIndex)),u=v.tickFormat()(p.y()(t.point,t.pointIndex)),f=l(t.series.key,o,u,t,e);n.tooltip.show([i,s],f,t.value<0?"n":"s")};return p.dispatch.on("tooltipShow",function(e){if(!Math.round(p.y()(e.point)*100))return setTimeout(function(){d3.selectAll(".point.hover").classed("hover",!1)},0),!1;e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],y.tooltipShow(e)}),p.dispatch.on("tooltipHide",function(e){y.tooltipHide(e)}),y.on("tooltipHide",function(){f&&n.tooltip.cleanup()}),e.dispatch=y,e.stacked=p,e.xAxis=d,e.yAxis=v,d3.rebind(e,p,"x","y","size","xScale","yScale","xDomain","yDomain","sizeDomain","interactive","offset","order","style","clipEdge","forceX","forceY","forceSize"),e.margin=function(n){return arguments.length?(t=n,e):t},e.width=function(t){return arguments.length?(r=t,e):getWidth},e.height=function(t){return arguments.length?(i=t,e):getHeight},e.color=function(t){return arguments.length?(s=t,m.color(t),e):s},e.showControls=function(t){return arguments.length?(o=t,e):o},e.showLegend=function(t){return arguments.length?(u=t,e):u},e.tooltips=function(t){return arguments.length?(f=t,e):f},e.tooltipContent=function(t){return arguments.length?(l=t,e):l},e}})()